# 12.4 红队演练设计

红队演练的设计质量决定演练价值能否实现。设计合理的演练可在可控风险下验证检测与响应能力，而设计不当可能导致业务中断或沦为形式主义。本节阐述演练设计的核心决策点：目标设定、范围界定、交战规则（RoE）、场景设计、时间规划及安全保障措施。

所有红队演练必须获得 CSO/CISO、法务及风险治理委员会的书面授权。未经授权的渗透测试活动可能触犯《网络安全法》第二十七条关于未经授权访问网络的规定。

## 12.4.1 演练目标设定

### 目标对齐的决策逻辑

演练目标必须与企业当前安全成熟度、业务风险优先级及监管要求对齐。目标设定错误会导致资源浪费或无法支撑后续决策。SMART 原则提供验证框架，但具体目标需从业务场景反推。

以支付系统演练为例，目标应从业务保护需求倒推：验证支付网关与订单系统的横向移动检测能力（具体）、要求 MTTD 不超过 15 分钟、MTTR 不超过 4 小时（可测）、基于当前 SOC 已部署的 SIEM 与 EDR 能力（可达）、支持 PCI DSS 11.3 合规要求（相关）、计划在季度末完成演练与整改（有时限）。

典型目标类型与适用场景：

1. 技术控制验证：验证 Active Directory 凭证窃取防护、云环境横向移动检测。适用于新上线技术控制或重大架构变更后。
2. 检测响应能力评估：评估 SOC 的 MTTD 与 MTTR 是否满足业务要求。适用于 SIEM/EDR 部署后的能力验证。
3. 业务防护验证：大促期间 DDoS 防护、支付系统欺诈交易检测。适用于高峰流量或营销活动前。
4. 合规审计支撑：满足 TIBER-EU 框架要求的威胁情报驱动演练。适用于金融、关基等强监管行业。
5. 人员意识测试：钓鱼邮件点击率、敏感信息处理合规性。适用于安全意识培训效果验证。

常见目标设定误区：

- 目标过于宽泛（"全面测试安全能力"无法量化验收）
- 脱离业务场景（测试场景与实际业务风险不匹配）
- 超出组织能力（要求 2 级成熟度团队实现 4 级目标）
- 缺少验收标准（演练后无法判断"成功"或"失败"）

### 目标验证与调整

演练前需确认：业务方是否理解并接受测试目标（避免演练中业务方抵制）、SOC/蓝队是否具备基础检测能力（避免演练变成单向突破）、演练结果能否支撑后续决策（如预算申请、流程优化）。

若目标在演练过程中发现不可达，裁判组需判断是调整目标还是中止演练。调整目标需书面记录并重新获得授权。

## 12.4.2 范围界定

### 范围界定的风险平衡

范围界定需平衡"演练真实性"与"业务可用性"。范围过窄（如仅测试环境）无法验证真实防护能力，范围过宽（如包含核心交易系统）可能导致业务中断。

In-Scope（包含范围）定义要素：

- 目标系统：明确是生产环境还是测试环境（如支付网关 `pay.example.com`、订单系统 `order.example.com`）
- 目标资产：精确到 IP 段、域名、应用 URL（如 `10.20.1.0/24`）
- 目标数据：指定可访问的数据类别（如测试用户数据、脱敏交易记录），禁止访问的数据（如真实客户 PII）
- 攻击路径：列出允许使用的技术手段（如内网侦察、凭证测试、横向移动）

Out-of-Scope（排除范围）定义要素：

- 禁止攻击的系统：核心交易数据库、实时支付处理系统等关键业务系统（任何可能导致业务中断的目标）
- 禁止时间：大促期间（双 11、618）、系统维护窗口、财务结算周期
- 禁止技术：DoS/DDoS 攻击、数据删除或加密、物理破坏、针对高管家属的社会工程
- 第三方系统：供应商接口、合作伙伴 SaaS 平台（需对方书面授权才可测试）

范围评估矩阵（用于范围决策）：

| 系统类型       | 业务影响 | 技术风险 | 演练建议             | 风险控制     |
| -------------- | -------- | -------- | -------------------- | ------------ |
| 生产交易系统   | 极高     | 高       | 仅假定突破或桌面推演 | 禁止实际操作 |
| 生产非核心系统 | 高       | 中       | 可演练，需实时监控   | 部署熔断机制 |
| 测试环境       | 低       | 低       | 优先演练目标         | 常规监控     |
| 办公网络       | 中       | 中       | 可演练社工/终端      | 避免高管/HR  |

生产交易系统（如核心支付网关、实时清算系统）因业务影响极高，通常仅适用于 Assumed Breach（假定突破）或 Tabletop（桌面推演）模式。生产非核心系统（如 CRM、内部工具）可进行演练，但需部署实时监控与熔断机制。测试环境是红队演练的优先目标，可用于验证攻击链完整性与检测规则有效性。办公网环境适合模拟钓鱼攻击、终端渗透等初始访问场景。

范围界定决策点：

- 首次演练建议从测试环境或低风险系统开始，验证流程后逐步扩展
- 高风险系统可采用 Assumed Breach 模式，从内网权限开始
- 跨境系统需评估数据本地化要求（如 GDPR、PIPL），避免数据跨境传输

常见界定失误：

- 范围描述不明确（"支付系统"未区分前端网关、后端清算、数据库）
- 遗漏隐含依赖（测试系统 A 导致依赖的系统 B 不可用）
- 未考虑时间窗口（演练时段恰逢流量高峰）
- 第三方系统未获授权（误攻击供应商系统引发法律风险）

## 12.4.3 交战规则（Rules of Engagement）

### RoE 的治理作用

交战规则是演练的法律与技术边界，明确"可为""禁为""必为"，保护演练各方（红队、蓝队、业务方、法务）的权责。RoE 不完善是演练失控的首要原因。

RoE 核心要素：

1. 授权与审批链路：

标准授权流程（不可跳过任何环节）：

1. 红队负责人提交演练计划（含目标、范围、技术方法、风险评估）
2. 裁判组审核 RoE 的完整性与可行性
3. 法务部门审查合规性（确保符合《网络安全法》《数据安全法》及行业监管要求）
4. GRC 团队评估风险等级并确认风险可接受
5. CSO/CISO 进行最终批准
6. 风险治理委员会备案（高风险演练需提交董事会）

整个授权流程通常需要 2-4 周，必须在演练启动前完成。

2. 时间窗口约束：

- 允许时间：演练起止时间（如某月某日 09:00 至某月某日 18:00），允许操作时段（工作日 9:00-18:00）
- 禁止时间：大促期间、系统发版窗口、财务结算日、已知系统不稳定期
- 时间延长审批：超出窗口需裁判组实时批准并记录

3. 技术方法限制：

允许的技术（需记录每次使用）：

- 钓鱼邮件（需使用无恶意 payload 的测试邮件，避免触发邮件网关）
- Web 漏洞利用（仅限非破坏性测试，如 SQL 注入读取但不修改数据）
- 凭证测试（每账户尝试次数 ≤10 次，避免触发账户锁定）
- 横向移动（仅限指定网段，如办公网 `10.10.0.0/16`）

禁止的技术（触发立即中止）：

- DoS/DDoS 攻击（任何可能导致服务不可用的行为）
- 数据删除或加密（包括勒索软件模拟）
- 物理破坏或物理入侵
- 针对高管家属的社会工程攻击

4. 数据处理规范：

- 生产数据访问：需双人审批（红队负责人+裁判组），访问时加密传输，禁止本地存储
- 数据脱敏要求：涉及 PII 数据仅记录字段存在性，不记录真实内容
- 数据销毁时限：演练结束后 7-14 天内销毁所有演练数据（需提供销毁证明）
- 证据保留：操作日志、截图需保留 36 个月（匹配审计要求）

5. 紧急中止机制（Kill Switch）：

触发条件（任一满足立即中止）：

- 业务指标异常：订单量下降 >5%、支付成功率下降 >3%
- 系统不可用：核心服务响应时间 >5 秒或 HTTP 5xx 错误率 >50%
- 数据泄露风险：发现真实客户数据被外传
- 合规违规：操作超出 RoE 授权范围
- 客服投诉激增：投诉量 >平时基线 3 倍

中止流程（严格执行）：

1. 裁判组决策（5 分钟内，电话会议）
2. 红队立即停止所有操作（含 C2 通信、持久化机制）
3. 运维团队恢复系统状态（目标 10 分钟内）
4. 根因分析（24 小时内提交报告：演练操作与异常的因果关系）

沟通机制：

- 红队↔裁判组：加密 IM（如 Signal）+ 紧急电话（24 小时值班）
- 裁判组↔管理层：专用邮件列表 + 每日简报
- 证据传递：加密存储（AES-256）+ 访问审计（记录所有读取操作）

### RoE 核心框架

RoE（Rules of Engagement）是红队演练的法律和操作基础。以下为核心框架结构，企业可根据实际场景扩展。

| 章节 | 必填项 | 说明 |
|-----|-------|------|
| **演练基本信息** | 名称、目标、类型、时间、负责人、裁判组 | 明确演练身份和范围 |
| **授权与批准** | CSO/CISO 签字、法务审查、GRC 审批 | 法律保障，必须在演练前完成 |
| **范围界定** | In-Scope 系统/IP、Out-of-Scope 系统、禁止触碰的数据类型 | 明确边界，避免越界操作 |
| **技术限制** | 允许的技术（需记录）、禁止的技术（触发中止） | 量化描述，避免"适度"等模糊表述 |
| **时间窗口** | 允许时段、禁止时段（发版窗口/节假日） | 避免与关键业务冲突 |
| **紧急中止** | 触发条件（业务指标阈值）、联系方式（24 小时） | 预设 Kill Switch 机制 |
| **数据处理** | 审批流程、日志记录、销毁时限 | 合规要求 |
| **签署确认** | 红队负责人、裁判组、CSO/CISO | 法律效力 |

RoE 示例片段：

```
范围界定:
  In-Scope:
    - 支付网关: pay.example.com (10.20.1.0/24)
    - 订单系统: order.example.com (10.20.2.0/24)
  Out-of-Scope:
    - 核心交易数据库: db-prod-01 (禁止直接访问)
    - 真实客户 PII: 禁止访问/记录

紧急中止触发条件:
  - 支付成功率下降 >3%
  - 订单处理延迟 >5 秒
  - 系统 CPU/内存 >80% 持续 5 分钟
```

RoE 常见问题与应对：

| 问题 | 应对 |
|-----|------|
| RoE 过于严格无法模拟真实攻击 | 分阶段放宽：先低风险场景后高风险场景 |
| RoE 描述模糊导致执行争议 | 量化所有限制（如"每账号 ≤10 次尝试"而非"适度测试"） |
| 未考虑隐含风险 | 预演 RoE 场景，识别横向影响（如防火墙规则阻断合法流量） |
| 异常时响应混乱 | 提前演练 Kill Switch 流程，确保联系方式有效 |

## 12.4.4 场景设计

### 攻击链设计的逻辑

场景设计需模拟真实威胁行为者的攻击路径，同时匹配企业当前的防护重点。场景不应是"为了攻击而攻击"，而是验证特定防护假设。

APT 攻击金融机构场景示例（完整攻击链）：

攻击链各阶段及对应检测点：

1. 侦察：OSINT 收集（目标：财务部门员工邮箱、技术栈）

   - 检测点：外部威胁情报（域名/邮箱被查询）
2. 钓鱼：发送财务主题钓鱼邮件

   - 检测点：邮件网关（链接/附件检测）、用户举报
3. 立足：Cobalt Strike Beacon 上线

   - 检测点：EDR 进程行为、C2 通信特征
4. 内网侦察：枚举域用户、共享文件夹

   - 检测点：异常 LDAP 查询、SMB 枚举
5. 凭证窃取：Mimikatz 抓取密码

   - 检测点：LSASS 访问、可疑 PowerShell
6. 横向移动：RDP 到核心网段

   - 检测点：异常登录（时间/地理位置）、横向 RDP
7. 权限提升：获取 Domain Admin

   - 检测点：高权限账户异常活动
8. 目标达成：访问交易数据库

   - 检测点：数据库异常查询、敏感表访问
9. 数据渗出：HTTPS 隧道外传

   - 检测点：DLP、异常流量（上传量、目标 IP）

场景设计决策点：

- 每个攻击阶段需对应至少一个检测假设（如"EDR 能检测 Mimikatz"）
- 攻击路径需符合威胁情报（如 APT 组织常用 TTP）
- 复杂度匹配团队能力（2 级成熟度团队不应设计需要 0day 的场景）

### 目标资产选择策略

关键资产分类（优先级从高到低）：

1. 皇冠明珠（Crown Jewels）：

   - 客户数据库（包含 PII 与支付信息）、支付系统（核心交易处理）、密钥管理系统（加密密钥与证书）
   - 演练建议：Assumed Breach 模式（假定已获得低权限），验证最后一道防线
2. 次级目标：

   - AD 域控（控制整个域环境）、堡垒机（访问生产系统的跳板）、代码仓库（可能包含硬编码凭证或 API 密钥）
   - 演练建议：完整攻击链，验证从外部到核心的路径
3. 跳板资产：

   - VPN 网关（远程访问入口）、办公终端（钓鱼攻击目标）、第三方接口（供应链攻击路径）
   - 演练建议：初始访问验证，测试边界防护

资产选择约束：

- 资产必须在 In-Scope 范围内
- 资产依赖关系需评估（攻击 A 是否影响 B）
- 资产数据敏感性需匹配数据处理授权

常见场景设计误区：

- 场景过于复杂导致演练周期过长（建议单次演练 ≤4 周）
- 场景脱离真实威胁（攻击路径在实际环境中不可行）
- 忽略业务逻辑攻击（仅关注技术漏洞，忽视营销羊毛、刷单）

### 互联网业务攻击场景设计

传统红队演练偏重技术渗透场景（如 APT 攻击链、内网横向移动），但对于电商、金融科技、互联网平台企业，业务逻辑攻击往往造成更直接的经济损失。以下为互联网业务场景的设计框架。

**场景一：促销活动薅羊毛**

攻击目标：绕过风控系统，批量获取营销资源（优惠券、红包、积分）

攻击路径设计：

1. 账号准备阶段
   - 批量注册账号（绕过手机验证码、图形验证码）
   - 养号策略（模拟正常用户行为，规避新账号风控）
   - 设备指纹伪造（修改设备 ID、MAC 地址、浏览器指纹）

2. 活动情报收集
   - 逆向分析 APP/H5 活动接口
   - 分析活动规则漏洞（如时间窗口、领取限制）
   - 监控活动预热信息

3. 自动化攻击执行
   - 开发抢券脚本（绕过前端校验、模拟正常请求频率）
   - 代理 IP 池轮换（规避 IP 限频）
   - 分布式任务调度（多机器协同抢购）

4. 资源变现
   - 优惠券转让/倒卖
   - 积分兑换高价值商品后转售
   - 利用价差套利

检测验证点：

| 攻击阶段 | 检测能力 | 预期告警 |
|---------|---------|---------|
| 批量注册 | 设备指纹识别、行为分析 | 异常注册聚集告警 |
| 养号行为 | 用户行为基线 | 异常用户画像标记 |
| 抢券请求 | API 频率限制、请求特征分析 | 异常请求模式告警 |
| IP 轮换 | 代理 IP 识别、地理位置跳变 | 可疑 IP 告警 |

**场景二：支付风控绕过**

攻击目标：利用支付流程漏洞完成欺诈交易

攻击路径设计：

1. 支付流程分析
   - 抓包分析支付接口参数
   - 识别金额校验逻辑（前端/后端）
   - 分析订单状态机漏洞

2. 漏洞利用尝试
   - 金额篡改（修改请求中的价格参数）
   - 订单状态跳变（直接调用支付成功回调）
   - 重放攻击（复用支付凭证）
   - 并发竞争（同一余额多次支付）

3. 风控规避
   - 分散交易金额（避免大额告警）
   - 模拟正常用户设备环境
   - 交易时间随机化

检测验证点：

| 攻击类型 | 检测能力 | 预期响应 |
|---------|---------|---------|
| 金额篡改 | 服务端金额校验、签名验证 | 交易拒绝 |
| 状态跳变 | 订单状态机校验 | 异常订单告警 |
| 重放攻击 | 幂等性校验、Token 时效 | 请求拒绝 |
| 并发竞争 | 分布式锁、余额原子操作 | 仅一笔成功 |

**场景三：账号体系攻击**

攻击目标：获取大量有效账号用于后续欺诈

攻击路径设计：

1. 撞库攻击
   - 收集外部泄露的账号密码库
   - 针对目标平台批量验证
   - 规避登录频率限制

2. 短信验证码攻击
   - 短信轰炸接口滥用
   - 验证码枚举（4-6 位验证码爆破）
   - 验证码转发劫持（SIM 卡克隆、SS7 攻击模拟）

3. 账号接管后利用
   - 窃取账户余额/积分
   - 获取用户隐私数据
   - 利用账号进行欺诈交易

检测验证点：

| 攻击阶段 | 检测能力 | 预期告警 |
|---------|---------|---------|
| 撞库请求 | 异常登录模式、IP 信誉 | 批量失败登录告警 |
| 验证码爆破 | 频率限制、验证码复杂度 | 验证码请求异常 |
| 账号异常登录 | 设备指纹、地理位置、行为分析 | 账号被盗告警 |

**业务场景演练的特殊要求**

1. 数据隔离：使用测试账号和模拟资金，禁止使用真实用户数据或影响真实交易
2. 风控协同：与风控团队提前沟通，避免触发生产环境封禁策略
3. 业务指标监控：实时监控 GMV、转化率等业务指标，设置更敏感的熔断阈值
4. 法律边界：营销资源套利可能涉及法律风险，演练仅验证检测能力，不实际获取资源

业务场景演练价值量化示例：

某电商平台 618 大促前红队演练发现优惠券领取接口缺乏设备指纹校验，攻击者可通过脚本批量领取。演练后推动修复，避免预估损失：

- 优惠券面值：50 元/张
- 预计被薅数量：10 万张
- 直接损失：500 万元
- 修复成本：2 人×1 周 = 10 万元
- ROI：50:1

## 12.4.5 时间规划

### 演练时间线设计

全方位红队演练（8 周标准周期）：

| 周次  | 阶段     | 核心活动                                | 交付物                     | 风险控制                       |
| ----- | -------- | --------------------------------------- | -------------------------- | ------------------------------ |
| W1-W2 | 规划     | RoE 签署、C2 基础设施搭建、工具免杀处理 | RoE 文档、技术准备检查清单 | 测试 C2 隐蔽性，避免上线即被封 |
| W3    | 侦察     | OSINT、外部资产扫描、钓鱼邮件模板       | 攻击面报告                 | 避免触发 WAF/IPS               |
| W4    | 初始访问 | 钓鱼邮件发送、Web 漏洞利用              | 立足点（Beacon 上线）      | 监控邮件点击率、系统稳定性     |
| W5-W6 | 内网渗透 | 横向移动、权限提升、域控突破            | 域管权限                   | 每日向裁判组汇报，避免过度横向 |
| W7    | 目标达成 | 数据访问、渗出模拟（不实际外传）        | 目标完成证明（截图/日志）  | 仅访问测试数据，禁止下载       |
| W8    | 清理     | 移除后门、恢复系统、证据整理            | 清理报告、系统恢复确认     | 双人验证清理完整性             |
| W9    | 报告     | 技术报告、管理层汇报、紫队复盘          | 演练报告、检测改进计划     | -                              |

规划阶段（W1-W2）需完成 RoE 签署、C2 基础设施搭建（如域名注册与重定向器配置）、工具准备（免杀处理）、与裁判组建立沟通渠道。侦察阶段（W3）通过 OSINT 收集公开情报并进行外部端口扫描，输出攻击面报告。初始访问阶段（W4）执行钓鱼攻击或 Web 漏洞利用，目标是获得至少一个立足点。内网渗透阶段（W5-W6）是演练的核心，需完成横向移动、凭证窃取、权限提升，最终获得域管理员或等效权限。目标达成阶段（W7）访问皇冠明珠资产并模拟数据渗出。清理阶段（W8）移除所有后门、C2 通道、修改的配置，并整理证据链。报告阶段（W9）编写技术报告与管理层汇报，召开紫队复盘会。

时间窗口选择决策：

最佳时机（业务影响最小）：

- 非业务高峰期（避开每月/每季度业务高峰）
- 发版冻结期后（新版本已稳定运行 2-4 周）
- 节假日前（确保关键人员在岗）

避免时机（高风险时段）：

- 大促期间（618、双 11、黑五前后 2 周）
- 重大发版窗口（系统变更频繁）
- 年终财报期（审计/合规压力大）
- 已知系统不稳定期（如近期发生过故障）

时间规划常见失误：

- 低估准备时间（C2 免杀处理、工具调试至少需 1 周）
- 未预留缓冲时间（演练中发现问题需调整，建议预留 20% 时间）
- 忽略业务日历（未与业务方确认关键时间节点）
- 报告周期过长（演练结束后超过 2 周才出报告，业务方失去耐心）

## 12.4.6 安全保障措施

### 多层风险控制

演练的风险控制采用"监控-预警-熔断"三层机制，确保业务影响在可接受范围内。

1. 技术监控面板：

实时监控指标（刷新频率 ≤1 分钟）：

业务指标（触发熔断阈值）：

- 订单量：下降 >5% 触发告警，>10% 触发熔断
- 支付成功率：下降 >3% 触发告警，>5% 触发熔断
- 接口延迟：P99 延迟 >5 秒触发告警，>10 秒触发熔断

系统指标（触发性能告警）：

- CPU 利用率：>80% 持续 5 分钟告警
- 内存利用率：>85% 告警
- 磁盘 IO：>90% 告警
- 网络带宽：出站流量 >基线 3 倍告警

安全指标（异常模式检测）：

- 告警数量：>100 条/小时（判断是否误报风暴）
- 失败登录：>1000 次/小时（判断凭证测试是否过度）
- 数据库慢查询：>50 条/小时（判断 SQL 注入影响）

熔断机制决策逻辑：

- 自动告警：指标超阈值 30 秒自动告警（发送至裁判组+运维）
- 人工介入：裁判组 5 分钟内决策（继续/暂停/中止）
- 自动回滚：关键系统配置备份，触发熔断后 10 分钟内恢复

2. 流程控制：

- 双人审批：高风险操作（如生产数据访问、权限提升）需红队负责人+裁判组双人确认
- 检查点机制：每阶段结束前进行风险评估（是否继续下一阶段）
- 日报制度：每日向裁判组提交进展（操作内容、发现问题、下一步计划）

3. 应急预案：

场景 1：业务指标异常

触发条件：订单量下降 >5% 或支付成功率下降 >3%

响应流程：

1. 立即暂停演练（T+0 分钟）
2. 红队提供最近 1 小时操作日志（T+5 分钟）
3. 运维排查根因并确认是否为演练导致（T+15 分钟）
4. 裁判组决策继续或终止演练（T+30 分钟）

场景 2：系统故障

触发条件：核心服务不可用或响应时间超过 SLA

响应流程：

1. 触发 Kill Switch，红队停止所有操作（T+0 分钟）
2. 运维恢复系统（SLA: 10 分钟）
3. 根因分析（24 小时内提交报告）
4. 决策后续演练（72 小时内，需重新评估风险）

场景 3：数据泄露风险

触发条件：DLP 检测到敏感数据外传

响应流程：

1. 立即中止演练（T+0 分钟）
2. 封锁网络（阻断外传 IP，T+5 分钟）
3. 启动数据泄露响应流程（按 Chapter 12 事件响应）
4. 法务/合规介入（评估影响，决定是否上报监管）

### 演练前检查清单

授权与合规：

- [ ] RoE 已获所有必要签字（CSO/CISO、法务、GRC）
- [ ] 法务确认数据处理合规（PIPL/GDPR）
- [ ] GRC 风险评估完成（风险评级、可接受性）
- [ ] 风险治理委员会已备案（重大演练需董事会知情）

技术准备：

- [ ] C2 基础设施测试通过（域名解析、重定向器、Listener 正常工作）
- [ ] 攻击工具免杀处理（EDR 环境验证通过）
- [ ] 备份恢复方案验证（关键系统配置已备份且可恢复）
- [ ] 监控面板部署（业务/系统/安全指标实时可见）
- [ ] 日志采集配置（Sysmon、EDR、网络流量日志正常采集）

协调沟通：

- [ ] 裁判组联系方式确认（电话与 IM 账号测试通过）
- [ ] 运维值班表获取（了解关键时段的值班人员）
- [ ] 业务值班表获取（了解业务负责人联系方式）
- [ ] 紧急联系流程测试（模拟一次 Kill Switch 触发）
- [ ] 加密通信信道建立（Signal 或企业加密 IM 配置完成）

业务窗口：

- [ ] 确认非大促期（避开 618、双 11 等高峰）
- [ ] 确认无重大发版（近期无系统变更计划）
- [ ] 业务指标基线确认（了解正常订单量、支付成功率）
- [ ] 系统稳定性确认（近期无故障记录）
- [ ] 业务方书面确认（业务负责人同意演练时间）

应急准备：

- [ ] Kill Switch 流程演练（模拟一次中止流程）
- [ ] 应急预案打印（纸质版备份，避免系统不可用时无法查阅）
- [ ] 恢复工具准备（系统恢复脚本与工具就绪）
- [ ] 备份验证（恢复测试通过）
- [ ] 故障响应团队待命（运维与安全团队保持在线）

证据管理：

- [ ] 加密存储准备（加密 U 盘或加密文件系统配置完成）
- [ ] 日志采集脚本测试（自动记录所有操作）
- [ ] 截图工具配置（每个关键步骤截图保存）
- [ ] 时间戳服务配置（确保证据时间准确）
- [ ] 证据链完整性验证（哈希校验机制就绪）

## 演练设计约束与风险应对

演练设计必须在以下约束条件下操作。业务优先约束要求演练价值不应以牺牲业务可用性为代价，若冲突则优先保障业务。风险可控约束要求多层控制机制（监控、预警、熔断）确保异常可快速止损。目标明确约束要求 SMART 目标可量化验收，避免"为了演练而演练"。循序渐进约束要求从低风险到高风险，从测试环境到生产环境，分阶段建立信任。协同共赢约束强调红队价值在于帮助蓝队提升，而非单纯"攻破"。

### 常见挑战与应对

| 挑战         | 根因                       | 失败表现                 | 应对策略                                              |
| ------------ | -------------------------- | ------------------------ | ----------------------------------------------------- |
| 业务方抵触   | 担心影响业务、不理解价值   | 不配合、拒绝授权         | 提前沟通、用业务语言、展示快速价值（如发现高危漏洞）  |
| RoE 过于严格 | 法务/GRC 过度保守          | 演练无法模拟真实攻击     | 分阶段放宽、风险分级审批、展示低风险演练成果          |
| 监控不足     | 缺少实时监控、阈值设置不当 | 业务异常无法及时发现     | 提前部署监控、设定明确阈值、演练前测试告警            |
| 清理不彻底   | 后门/配置残留              | 留下安全隐患、被外部利用 | 清理检查清单、双人验证、蓝队协助排查                  |
| 报告不专业   | 技术细节过多、缺少业务语言 | 管理层无法理解价值       | 分层汇报（技术/管理层）、量化业务影响、提供修复优先级 |

风险应对验证：

- 每个挑战需在演练前评估发生概率与影响
- 高概率挑战需提前制定缓解措施（如业务方抵触需提前宣讲）
- 演练后复盘实际发生的挑战与应对效果

## 本节小结

演练设计的核心是在"真实性"与"安全性"之间找到平衡点。关键决策点包括：

1. 目标设定：与业务对齐的 SMART 目标，可量化验收。
2. 范围界定：明确 In-Scope/Out-of-Scope，平衡演练价值与业务风险。
3. 交战规则：完整的 RoE 覆盖授权、技术限制、数据处理、紧急中止机制。
4. 场景设计：模拟真实攻击链，每阶段对应检测假设。
5. 时间规划：避开业务高峰，预留缓冲时间。
6. 安全保障：多层监控、熔断机制、应急预案。

演练前检查清单确保所有控制点已就位，避免演练中手忙脚乱。演练设计的成熟度直接影响后续执行与价值输出。


---

## 导航

**[← 上一节：12.3 工具与技术](./12.3-tools-techniques.md)** | **[返回章节目录](./README.md)** | **[下一节：12.5 紫队协作 →](./12.5-purple-teaming.md)**

---

**© 2025 AI-ESA Project. Licensed under CC BY-NC-SA 4.0**
