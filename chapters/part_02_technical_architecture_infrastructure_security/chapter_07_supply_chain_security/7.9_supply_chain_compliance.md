# 7.9 供应链安全合规

供应链安全已从工程最佳实践演变为法规要求。美国联邦行政命令 14028 要求联邦采购软件必须提交 SBOM，欧盟《网络弹性法案》(Cyber Resilience Act) 要求数字产品通过安全认证，金融与医疗行业监管机构强制要求软件供应商证明安全开发实践。本节整理全球主要供应链合规框架的核心要求、实施路径与验收标准，帮助组织在满足监管要求的同时建立可持续的供应链安全能力。

---

## 7.9.1 全球供应链安全监管要求

### 主要法规与标准覆盖

| 法规/标准 | 颁布机构 | 生效时间 | 适用范围 | 核心要求 |
|----------|---------|---------|---------|---------|
| **Executive Order 14028** | 美国白宫 | 2021 年 5 月 | 向联邦政府销售软件的供应商 | SBOM 提交、遵循 NIST SSDF、参与漏洞披露计划、维护来源证明 |
| **NIST SSDF (SP 800-218)** | NIST | 2022 年 2 月 | 所有软件开发组织 | 4 大实践组、22 项具体实践 |
| **SLSA** | OpenSSF 社区 | 持续演进 | 软件制品供应链 | Level 1-4 构建完整性等级 |
| **EU Cyber Resilience Act** | 欧盟委员会 | 预计 2024 年 12 月 | 在欧盟销售的数字产品 | 安全设计、CE 标识、支持期限、漏洞管理 |
| **NIS2 Directive** | 欧盟 | 2024 年 10 月 | 关键基础设施运营者 | 供应链风险管理、事件报告、安全审计 |
| **FDA 医疗器械网络安全要求** | 美国 FDA | 2023 年 3 月 | 医疗设备制造商 | SBOM 提交、安全更新计划、风险管理文档 |
| **ISO/IEC 27036** | ISO/IEC | 持续维护 | 全球范围供应商关系 | 供应商选择、合同安全条款、持续监控 |

美国 EO 14028 影响范围最广，要求软件供应商提供机器可读的 SBOM、遵循 NIST SSDF 框架、建立漏洞披露渠道。欧盟 CRA 覆盖所有数字产品，将强制要求 CE 标识与安全认证，且规定最低 5 年安全支持期限。金融行业 (FFIEC、PCI DSS) 与医疗行业 (FDA、HIPAA) 均在各自领域增强了供应链安全要求，中国《网络安全法》《数据安全法》要求关键信息基础设施运营者对供应链进行安全审查。

### 适用边界与合规强制性

强制合规场景包括：向美国联邦政府销售软件 (EO 14028)、在欧盟销售数字产品 (CRA)、向医疗机构提供医疗设备 (FDA 要求)、处理支付卡数据 (PCI DSS 要求)、运营关键基础设施 (NIS2、中国网络安全法要求)。建议合规场景包括：为大型企业提供 SaaS 服务 (客户常要求 SBOM 与 SOC 2 Type II)、开源软件项目 (SLSA 认证可增强信任)、参与政府采购投标 (即使非强制，合规可提高竞标竞争力)。

豁免条件：纯内部使用软件通常不受 EO 14028 约束 (但如果托管在云服务商，云服务商可能要求合规)；开源个人项目不受商业产品合规要求约束 (但大型开源基金会项目如 Linux 内核、Kubernetes 已主动采用 SLSA 等标准)；嵌入式固件可能受行业特定标准约束而非通用软件合规要求。

---

## 7.9.2 美国 Executive Order 14028 合规实施

### SBOM 最低要求 (NTIA Minimum Elements)

美国国家电信和信息管理局 (NTIA) 定义了 SBOM 必须包含的最低数据字段，这是 EO 14028 合规的基础：

数据字段 (Data Fields) 包括供应商名称 (提供组件的实体)、组件名称 (软件单元的标识)、版本标识符 (区分组件不同版本)、唯一标识符 (CPE、PURL 等包管理器标识符)、依赖关系 (上下游组件的关联)、SBOM 创建者 (生成 SBOM 的实体或系统)、时间戳 (SBOM 生成时间，采用 ISO 8601 格式)。

自动化支持要求：SBOM 必须使用机器可读格式 (SPDX、CycloneDX 或 SWID 标签)，支持通过 API 或下载方式访问，便于自动化漏洞关联与合规审计。

实践与流程要求：SBOM 应在每次构建时自动生成，包含完整依赖树 (不仅限于直接依赖)，支持增量更新 (组件版本变更后重新生成)，并提供访问机制 (如公开 API 端点或附加在容器镜像)。

![SBOM生命周期管理](../../../assets/images/chapter_07/02_SBOM_Lifecycle_v6.png)

### 合规实施示例

以下示例展示如何在 CI/CD 流水线中生成符合 EO 14028 要求的 SBOM、签名与发布：

生成 SBOM：使用 Syft 工具生成 CycloneDX 格式 SBOM，包含所有直接与传递依赖、版本信息与 PURL 标识符。验证合规性：检查 SBOM 是否包含所有 NTIA 必需字段 (bomFormat、specVersion、metadata.timestamp、components.name/version/purl)。签名 SBOM：使用 Cosign 对 SBOM 进行密码学签名，生成签名证书包，确保 SBOM 未被篡改。发布 SBOM：将 SBOM 附加到容器镜像 (通过 Cosign attach sbom 命令)，上传到公开 API 端点，或包含在软件发行包中。生成 VEX 文档：对于 SBOM 中发现的漏洞，生成 VEX (Vulnerability Exploitability eXchange) 文档说明漏洞在特定产品中的可利用性状态 (not_affected、affected、fixed、under_investigation)。

常见误区：
- 仅生成直接依赖 SBOM 而忽略传递依赖（传递依赖常是漏洞来源，必须包含完整依赖树）
- SBOM 仅在发布时生成一次（应在每次构建时自动生成，确保 SBOM 与制品一致）
- 不验证 SBOM 格式合规性（NTIA 合规检查器可自动验证 SBOM 是否包含所有必需字段）
- 忽略 SBOM 签名（未签名 SBOM 可能被篡改，签名是 EO 14028 的隐含要求）

验证方法：使用 NTIA SBOM 工具 (如 sbomqs) 验证 SBOM 质量评分，检查 SBOM 签名有效性 (cosign verify-blob)，测试 SBOM API 端点可访问性，使用漏洞扫描工具 (如 Grype) 关联 SBOM 与 CVE 数据库验证漏洞检测能力。

运行指标：SBOM 生成成功率 (目标≥99.5%，避免构建失败阻断发布)、SBOM 格式合规率 (所有 SBOM 通过 NTIA 最低要素检查)、SBOM 覆盖度 (SBOM 中组件数量与实际依赖数量的比率，目标 100%)、SBOM 访问响应时间 (API 端点响应时间<2 秒)。

---

## 7.9.3 NIST SSDF (SP 800-218) 实施指南

### SSDF 四大实践组架构

NIST 安全软件开发框架 (SSDF) 定义了 22 项实践，归类为 4 个实践组：

PO (Prepare the Organization，准备组织)：定义安全需求、实施角色与责任、建立支持工具链、定义可重复流程、实施人员培训。此实践组建立组织级安全开发能力基线，确保安全融入组织文化与流程。

PS (Protect the Software，保护软件)：保护代码仓库免受篡改、提供安全的软件组件供应链、归档软件完整性证明。此实践组确保软件在开发与构建过程中的完整性与可溯源性。

PW (Produce Well-Secured Software，生产安全软件)：设计时考虑安全、安全构建环境、安全分发产品、安全处理客户反馈、响应漏洞。此实践组涵盖从设计到发布的安全实践。

RV (Respond to Vulnerabilities，响应漏洞)：识别漏洞、评估与优先级排序、修复漏洞、分析根因。此实践组确保组织能快速响应新发现的漏洞。

### 关键实践实施要点

PO.1 (定义和使用安全需求)：记录适用的安全标准 (如 OWASP Top 10、CWE Top 25)、数据保护要求 (加密算法、访问控制策略)、供应链安全要求 (SBOM 强制、签名验证)。将安全需求集成到需求管理系统 (如 Jira、Azure DevOps)，在设计评审时验证需求满足情况。

PS.1 (保护代码仓库)：对所有账户启用 MFA、配置分支保护规则 (要求代码审查、禁止强制推送)、要求签名提交 (git commit -S)、实施最小权限访问 (使用 RBAC 限制仓库访问权限)。审计所有对构建系统的访问 (记录谁在何时触发了哪次构建)。

PS.2 (提供安全组件)：仅使用可信来源组件 (如官方包管理器仓库、经过安全审查的内部镜像)、验证组件签名 (npm verify signatures、apt-key verify)、扫描所有第三方组件 (使用 SCA 工具如 Snyk、Trivy)、维护批准组件清单 (白名单机制)。

PW.1 (设计时考虑安全)：在架构设计阶段进行威胁建模 (使用 STRIDE、PASTA 等方法)、识别信任边界、评估攻击面、定义安全控制 (如输入验证点、身份验证机制)。遵循 OWASP 安全编码指南，使用参数化查询防止 SQL 注入，对所有用户输入进行验证与编码。

RV.2 (漏洞优先级排序与修复)：综合 CVSS 评分、EPSS (被利用概率)、是否存在公开 PoC、资产关键性计算优先级，定义修复时间线 (P0 级 24 小时、P1 级 7 天、P2 级 30 天、P3 级 90 天)。对于无法立即修复的漏洞，部署临时缓解措施 (如 WAF 规则、网络隔离)。

适用边界：SSDF 适用于所有软件开发组织，无论规模大小，但实施深度可根据风险与资源调整。小型团队可优先实施 PO.3 (工具链) 与 PW.2 (安全测试)，大型组织需全面实施 22 项实践并定期评估成熟度。

关键约束：全面实施 SSDF 需要组织文化变革与工具投资，初期会增加开发流程复杂度，需要平衡安全与交付速度。SSDF 不规定具体工具或技术，组织需根据技术栈选择合适实施方式。

验证方法：使用 SSDF 自评估检查清单逐项验证实施情况，每项实践定义"已实施"的具体证据 (如 PO.3 需提供工具清单与集成配置、PS.1 需提供分支保护策略截图)。邀请独立第三方进行 SSDF 成熟度评估 (如 SOC 2 审计可覆盖部分 SSDF 实践)。

运行指标：SSDF 实践实施率 (已实施实践数/22，目标≥80%)、安全缺陷逃逸率 (生产环境发现的安全缺陷数/总缺陷数，目标<5%)、漏洞修复时间 (P0 级平均修复时间<24 小时)、安全培训覆盖率 (开发人员每年接受安全培训比例，目标 100%)。

### SSDF 合规自证明

组织可通过自证明文档向客户或监管机构证明 SSDF 合规性，文档应包括：组织与产品基本信息、22 项实践的实施状态 (已实施/部分实施/未实施)、每项实践的实施方式说明、支持证据清单 (SBOM、SLSA 证明、审计报告、渗透测试报告)、签署人与日期。自证明不等同于第三方认证，但可作为合规承诺的正式声明，部分联邦合同可能要求供应商提供 SSDF 自证明。

---

## 7.9.4 SLSA 供应链等级认证

![SLSA 框架等级](../../../assets/images/chapter_07/03_SLSA_Framework_v6.png)

### SLSA 等级要求

SLSA (Supply-chain Levels for Software Artifacts) 定义了构建完整性的 4 个等级，每个等级对应更严格的供应链安全控制：

SLSA Level 1 (文档化构建)：要求生成构建证明 (provenance)，记录构建过程的基本信息 (构建时间、使用的构建脚本、输入源代码版本)。此等级不要求构建环境隔离或防篡改，适用于开源项目建立基础可溯源性。

SLSA Level 2 (托管构建)：要求使用托管构建服务 (如 GitHub Actions、GitLab CI、Google Cloud Build) 自动生成不可篡改的证明，构建服务必须记录完整构建日志且不可由构建触发者修改。此等级防止开发者手动篡改构建产物，但不防止构建环境被入侵。

SLSA Level 3 (强化构建)：要求使用临时隔离的构建环境 (每次构建后销毁)、所有外部依赖通过哈希验证、构建证明由构建服务密钥签名 (非构建触发者密钥)。此等级可防止构建环境持久化攻击 (如 SolarWinds 攻击场景)。

SLSA Level 4 (可重现构建)：要求两个独立构建环境使用相同输入生成字节级相同的制品，确保构建过程完全确定性无隐藏依赖。此等级是最高安全保障，但实施难度高，需要解决编译器非确定性、时间戳嵌入等技术问题。

### 实施路径与技术约束

达成 SLSA Level 2：迁移到托管 CI/CD 服务 (GitHub Actions、GitLab CI)，使用官方 SLSA 生成器 (如 slsa-github-generator)，配置构建工作流自动生成并签名证明。约束：需要信任托管服务提供商，构建环境配置灵活性受限 (不能随意安装构建依赖)。

达成 SLSA Level 3：使用容器化临时构建环境 (每次构建启动新容器)、锁定所有依赖版本与哈希 (如 npm package-lock.json、go.sum)、使用 Sigstore Cosign 签名制品、实施构建环境审计 (记录构建环境镜像哈希与网络访问)。约束：需要额外基础设施 (容器镜像仓库、密钥管理系统)，构建时间增加 (每次拉取镜像与验证依赖)，依赖锁定可能延迟安全补丁更新。

达成 SLSA Level 4：实施可重现构建工具链 (如 Reproducible Builds 项目工具)、消除所有非确定性源 (禁用时间戳、排序文件列表、固定编译器版本)、使用独立构建验证服务。约束：技术难度极高，多数编程语言与构建工具不原生支持可重现构建，需要深度定制构建流程，维护成本高。

常见误区：认为 SLSA Level 4 是所有项目必需 (大多数项目 Level 2 或 Level 3 已足够)，仅关注证明生成而忽略验证 (下游消费者必须验证证明，否则证明无意义)，将 SLSA 等同于全面供应链安全 (SLSA 仅覆盖构建完整性，不覆盖源代码安全、运行时保护)。

验证方法：使用 slsa-verifier 工具验证制品的 SLSA 证明有效性，检查证明中的 builder.id 是否为受信任的构建服务，验证证明签名与制品哈希匹配，审计构建日志确认构建环境隔离配置。

运行指标：SLSA 证明生成成功率 (每次发布自动生成有效证明，目标 100%)、证明验证通过率 (下游验证证明的成功率)、构建可重现率 (Level 4：两次独立构建生成相同制品的比率，目标≥95%)。

---

## 7.9.5 欧盟 Cyber Resilience Act 合规准备

### CRA 核心义务

《网络弹性法案》(预计 2024 年 12 月生效) 适用于在欧盟销售的所有数字产品，包括硬件、软件与 SaaS 服务。核心义务包括：

安全设计与默认配置：产品必须采用安全设计原则 (security by design)，默认配置满足最小权限 (所有默认凭证必须唯一、禁用不必要服务)、自动安全更新机制、数据加密 (传输中与静态)。

漏洞管理：建立公开的漏洞披露政策、提供安全联系方式 (security@域名或 security.txt 文件)、定义漏洞响应 SLA (严重漏洞 24 小时内响应)、实施协调披露计划 (与安全研究人员协作修复漏洞后再公开)。

支持期限：产品必须提供至少 5 年安全支持 (从产品首次投放市场起计算)，期间提供安全更新，若提前终止支持需提前至少 1 年通知用户。此要求对硬件嵌入式软件与 SaaS 服务均适用。

CE 标识与合格评定：根据产品风险等级 (Class I/II/Critical) 进行自我评估或第三方评估，获得 EU 符合性声明，加贴 CE 标识。Class I 产品可自我评估，Class II 需第三方评估，Critical 产品需 EU 认证机构认证。

事件报告：主动被利用的漏洞需在 24 小时内向 ENISA 报告，严重安全事件需在 72 小时内报告，报告内容包括受影响产品、漏洞详情、缓解措施。

### CRA 产品分类与评估要求

Class I (普通产品)：智能家居设备、一般商用软件、非关键物联网设备。要求自我评估，编制技术文档 (风险评估、测试报告)，保留 10 年备查。

Class II (重要产品)：工业控制系统、企业防火墙、操作系统。要求第三方评估，由通知机构 (Notified Body) 审查技术文档与测试结果，颁发合格证书。

Critical (关键产品)：关键基础设施组件 (如电网控制系统、医疗设备、航空电子设备)。要求 EU 认证，最严格审查，需持续监督。

适用边界：开源软件项目不受 CRA 约束 (但基于开源软件的商业产品受约束)，纯内部使用软件不受约束 (但 SaaS 服务受约束)，安全研究工具与渗透测试工具豁免。

关键约束：5 年支持期限对软件供应商商业模式有重大影响 (需考虑长期维护成本)，CE 认证流程需要较长认证周期 (需提前规划产品上市时间)，事件报告要求可能与公司保密政策冲突 (需建立合规报告流程)。

常见误区：认为开源项目豁免适用于所有基于开源的产品 (仅个人开源项目豁免，商业化产品需合规)，混淆 Class I/II/Critical 分类导致选择错误评估路径 (需根据产品实际风险等级确定)，忽视 5 年支持期限的商业影响 (需在产品定价与商业模式中考虑长期维护成本)。

验证方法：使用 CRA 合规检查清单逐项自评，委托通知机构进行预评估 (识别差距)，进行渗透测试验证安全控制有效性，审查漏洞披露政策与安全联系方式可访问性。

运行指标：安全更新发布频率 (严重漏洞修复时间<7 天)、漏洞披露响应时间 (收到报告后首次响应时间<24 小时)、事件报告及时性 (24/72 小时内向 ENISA 报告比率，目标 100%)、技术文档完整性 (合格评定所需文档齐全率)。

---

## 7.9.6 ISO/IEC 27036 供应商关系安全

### ISO 27036 标准覆盖范围

ISO/IEC 27036 系列标准规范了供应商关系中的信息安全要求：

ISO 27036-1 (概述与概念)：定义供应链信息安全的术语、角色 (供应商、采购方、第三方)、安全目标 (保密性、完整性、可用性、可追溯性)。

ISO 27036-2 (要求)：规定供应商选择、合同安全条款、持续监控、事件管理的具体要求，适用于各行业供应商关系管理。

ISO 27036-3 (ICT 供应链安全指南)：针对硬件、软件与服务供应链提供详细控制措施，包括 SBOM 管理、制品验证、供应链审计。

ISO 27036-4 (云服务安全指南)：针对云服务提供商 (CSP) 的特殊要求，包括数据驻留、加密密钥管理、审计日志访问、供应商锁定风险。

### 供应商风险评估框架

ISO 27036 要求对供应商进行多维度风险评估，综合考虑安全控制、数据保护、供应链透明度、事件响应能力、合规认证、财务稳定性、地理风险。每个维度评分 1-5 分，使用加权平均计算综合风险评分，根据评分确定风险等级 (低/中/高/严重) 与相应管理策略。

低风险供应商 (综合评分≥4.5)：实施标准管理流程，年度安全审查，标准合同条款，无需额外补偿控制。

中风险供应商 (3.5≤评分<4.5)：持续监控，半年度安全审查，SLA 合同条款，要求提供 SBOM 与漏洞通知。

高风险供应商 (2.5≤评分<3.5)：进行现场安全审计，要求 ISO 27001 或 SOC 2 Type II 认证，季度安全审查，实施补偿控制 (如数据加密、网络隔离)。

严重风险供应商 (评分<2.5)：不建议使用，如必须使用需高管批准，实施严格补偿控制，寻找替代供应商。

适用边界：ISO 27036 适用于所有涉及敏感数据或关键业务的供应商关系，包括 SaaS 供应商、开源软件维护者、硬件供应商、外包开发团队。不适用于纯商品采购 (无信息安全风险)。

关键约束：全面实施 ISO 27036 需要专职供应商风险管理团队 (TPRM 团队)，评估流程可能延长供应商准入时间 (从几天延长到几周)，持续监控需要自动化工具支持 (如供应商风险评级平台)。

常见误区：仅依赖供应商安全问卷而不验证实际控制 (问卷回答可能不准确，需通过审计或证书验证)，将风险评估视为一次性准入活动 (供应商风险持续变化，需定期重新评估)，忽略低风险供应商的监控 (供应商风险等级可能上升，需持续监控所有供应商)。

验证方法：审查供应商安全问卷完整性 (是否覆盖 ISO 27036-2 所有要求域)，检查合同中安全条款是否包含 SBOM 提供、漏洞通知、审计权、数据删除权，验证供应商监控流程有效性 (如漏洞情报订阅、定期评审记录)。

运行指标：供应商评估覆盖率 (关键供应商接受风险评估比例，目标 100%)、高风险供应商比例 (目标<10%)、供应商安全事件响应时间 (供应商发生安全事件后通知时间，目标<24 小时)、供应商审计频率 (按风险等级执行审计的及时性)。

---

## 7.9.7 合规成熟度评估与实施检查清单

### 合规能力分级模型

基础级 (0-25 分)：生成 SBOM (任何格式)、基础漏洞扫描、书面安全政策、年度安全培训、基础事件响应计划、供应商安全审查、代码审查流程。此级别满足最低合规要求，适用于内部使用软件或低风险场景。

中级 (26-60 分)：在基础级基础上，实施 EO 14028 合规 (NTIA-compliant SBOM、SBOM 签名与 API 访问)、NIST SSDF 四大实践组部分实施、SLSA Level 2 证明。此级别适用于向企业客户销售 SaaS 服务或参与政府采购。

高级 (61-90 分)：在中级基础上，获得 ISO 27001 认证、SOC 2 Type II、EU CRA 合规 (如适用)、实施完整漏洞披露计划。此级别适用于大型企业或受监管行业。

专家级 (91-100 分)：在高级基础上，达成 SLSA Level 4、获得 FedRAMP 认证 (如适用)、实施可重现构建。此级别适用于关键基础设施供应商或高安全要求场景。

组织应根据业务场景与监管要求确定目标成熟度等级，优先实施高价值实践 (如 SBOM 生成与签名)，避免为达到高分而实施不必要的控制 (如非关键系统不需 SLSA Level 4)。

### 实施优先级排序

第一优先级 (0-3 个月)：建立 SBOM 自动生成流程、实施基础漏洞扫描 (SCA 集成到 CI/CD)、配置分支保护与 MFA、编写安全开发政策文档。

第二优先级 (3-6 个月)：实施 NIST SSDF PO 与 PS 实践组、达成 SLSA Level 2、建立供应商风险评估流程、实施自动化安全测试 (SAST/DAST)。

第三优先级 (6-12 个月)：实施 NIST SSDF PW 与 RV 实践组、达成 SLSA Level 3、获得 SOC 2 Type II 认证、建立漏洞披露计划、准备 EU CRA 合规 (如适用)。

第四优先级 (12 个月以上)：达成 SLSA Level 4、获得 ISO 27001 认证、实施可重现构建、申请 FedRAMP 认证 (如适用)。

常见误区：追求最高等级认证而忽略基础控制 (应先确保 SBOM 生成稳定再追求 SLSA Level 4)，仅为合规而合规未融入日常流程 (合规控制应自动化而非手动操作)，过度依赖第三方认证而忽略自身能力建设 (认证是能力证明而非能力本身)。

验证方法：使用本节提供的合规检查清单逐项自评，记录每项控制的实施证据，邀请独立第三方进行差距分析 (GAP Analysis)，对关键控制进行有效性测试 (如红队测试验证构建环境隔离)。

运行指标：合规检查清单完成率 (已实施控制项/总控制项)、合规控制失效次数 (季度内合规控制失效导致的事件数，目标 0)、审计发现整改及时率 (审计发现问题在规定时间内关闭比例，目标≥95%)、合规培训覆盖率 (相关人员接受合规培训比例，目标 100%)。

---

## 本节小结

供应链安全合规要求持续演进，组织应建立动态合规管理能力而非一次性达标。核心实施路径包括：建立自动化 SBOM 生成与发布流程 (满足 EO 14028 与多数监管要求)、遵循 NIST SSDF 框架建立安全开发基线、根据风险等级选择合适 SLSA 等级 (Level 2 适用于大多数场景)、对欧盟市场产品提前准备 CRA 合规、实施 ISO 27036 供应商风险管理框架。

合规不等于安全，但合规要求通常反映行业最佳实践，通过系统化实施合规框架可显著提升供应链安全能力。组织应避免为合规而合规，而是将合规要求融入工程流程，通过自动化降低合规成本，将合规能力转化为竞争优势 (如 SBOM 可增强客户信任、SLSA 证明可简化客户安全审查)。

---

## 导航

**[← 7.8 供应链风险检测与响应](./7.8_supply_chain_risk_detection.md)** | **[返回本章目录](./README.md)** | **[7.10 案例研究 →](./7.10_case_studies.md)**

---

**© 2025 AI-ESA Project. Licensed under CC BY-NC-SA 4.0**
