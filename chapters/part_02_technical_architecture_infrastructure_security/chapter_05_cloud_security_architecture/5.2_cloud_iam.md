# 5.2 云身份与访问管理 (Cloud Identity and Access Management)

本节建立云环境身份与访问管理的完整控制体系,从统一身份管理、多云IAM策略、特权访问管理、零信任架构到IAM治理审计,提供从架构设计到运营落地的可执行方案。

---

## 5.2.1 统一身份管理:从身份孤岛到中心化控制

### 多云环境身份管理的核心挑战

云环境将身份管理的复杂度放大了一个数量级。传统企业IT环境通常维护单一的Active Directory或LDAP目录,员工使用统一凭证访问内部系统。但多云环境打破了这种统一性:AWS IAM、Azure AD、GCP IAM各自维护独立的用户目录和权限模型,SaaS应用(Salesforce、Workday、Slack等)又引入了新的身份孤岛。

这种分散化导致三个关键问题:第一,**身份生命周期管理断裂**——员工入职时需要在多个系统分别创建账户,离职时容易遗漏某个云平台的账户禁用,导致"僵尸账户"长期存在;第二,**密码管理负担**——用户需要记忆多套密码(或被迫在多个系统重用同一密码,引入安全风险),IT Helpdesk被密码重置请求淹没;第三,**审计追踪困难**——跨云日志分散存储,无法快速回答"某员工在过去30天访问过哪些云资源"这类合规审计问题。

2019年Capital One数据泄露事故提供了惨痛教训。攻击者利用一个配置错误的IAM角色,通过SSRF漏洞窃取EC2实例的临时凭证,进而访问了所有S3存储桶中的敏感数据,影响1.06亿客户,导致罚款超过3亿美元。事后调查显示,该IAM角色本应只有读取元数据的权限,但由于多个策略层叠且缺乏统一治理,实际权限包含了ListBucket和GetObject操作。这起事故的核心问题不是技术漏洞,而是**缺乏统一身份治理导致的权限配置混乱**。

![多云IAM架构](../../../assets/images/chapter_05/03_Multi_Cloud_IAM_v6.png)

### 统一身份管理架构设计

统一身份管理架构采用三层模型:

**第一层:唯一身份源(Identity Source)**。企业HR系统(如Workday、SAP SuccessFactors)作为权威身份数据源,定义员工的唯一标识符、组织架构、职位信息。所有身份变更(入职、调岗、离职)必须且仅在HR系统中发起,确保单一真实来源(Single Source of Truth)。

**第二层:中央身份提供商(Central IdP)**。部署企业级身份平台(Okta、Azure AD、Ping Identity),通过SCIM协议自动从HR系统同步用户数据,并作为统一的认证授权中心。中央IdP负责:用户认证(SSO登录)、多因素认证(MFA)、条件访问策略(基于用户属性、设备状态、网络位置的动态授权)、会话管理(超时、并发登录控制)。

**第三层:目标应用(Target Applications)**。包括云平台(AWS、Azure、GCP)和SaaS应用(Salesforce、Slack、Workday等)。这些应用通过联邦身份协议(SAML 2.0或OIDC)信任中央IdP,用户通过IdP完成认证后,IdP向应用颁发包含用户身份和属性的令牌(SAML断言或JWT),应用据此授予访问权限。关键是目标应用不再维护本地用户账户和密码,所有身份管理职责上移到中央IdP。

这种架构的核心优势在于将身份管理从"N×M问题"(N个用户在M个系统分别创建账户)简化为"N+M问题"(N个用户在1个IdP注册,M个系统信任该IdP)。员工离职时,只需在HR系统标记离职状态,变更自动同步到IdP并触发所有关联应用的访问撤销,从根本上消除"僵尸账户"问题。

### 身份提供商技术选型对比

主流SSO平台在协议支持、多云集成能力、自动化能力上存在显著差异:

**Okta**定位为独立的身份平台,支持SAML 2.0、OIDC、OAuth 2.0、WS-Federation全套联邦协议,与7000+SaaS应用预集成(包括AWS、Azure、GCP、Salesforce、Workday等),支持SCIM 2.0协议自动化用户生命周期管理。核心优势是**多云支持均衡**——对AWS、Azure、GCP三朵云的集成深度相当,且提供强大的REST API供企业定制自动化流程(如与内部工单系统集成)。典型部署成本:100用户约5000-8000美元/年,1000用户约40000-80000美元/年(基于功能模块和用户数阶梯定价)。适用场景:多云环境、需要高级条件访问策略、API自动化需求强。

**Azure AD(现更名为Microsoft Entra ID)**深度集成微软生态,对Azure资源的IAM管理原生支持,同时支持AWS、GCP的SAML联邦。优势在于**成本效益**——P1许可证约6美元/用户/月,P2许可证约18美元/用户/月,对于已购买Microsoft 365 E3/E5的企业,Azure AD功能部分包含在订阅中,边际成本低。但需要注意,Azure AD作为混合IdP(既可作为IdP向其他应用提供身份,也可作为SP从外部IdP接收身份),在与第三方IdP(如Okta)集成时配置复杂度较高,需要配置Hybrid Join或Azure AD Connect同步本地AD。适用场景:微软技术栈为主、成本敏感、已有Microsoft 365订阅。

**AWS IAM Identity Center(原AWS SSO)**是AWS原生的SSO服务,免费提供给AWS客户,支持SAML 2.0和OIDC协议,与AWS Organizations深度集成,可管理多个AWS账户的联邦访问。主要限制在于**多云和SaaS集成能力较弱**——虽然理论上支持任何SAML 2.0应用,但预集成应用列表仅300+,远少于Okta的7000+,且SCIM自动化provisioning功能需要手动配置。适用场景:纯AWS环境、小规模部署(100用户以下)、成本预算极其有限。

### SAML与OIDC协议技术对比

SAML 2.0和OIDC是两种主流联邦身份协议,技术栈和适用场景差异明显:

**SAML 2.0**诞生于2005年,采用XML格式传输身份断言,通过HTTP POST或Redirect绑定传递认证请求和响应。认证流程:用户访问应用(Service Provider)→应用检测未认证,生成SAML AuthnRequest并302重定向到IdP→用户在IdP登录→IdP生成包含用户属性的SAML断言(XML格式,包含数字签名)→IdP将断言POST回应用→应用验证签名并建立会话。

SAML的技术特点:XML格式冗长但结构严谨,数字签名机制成熟(支持XML Signature和XML Encryption),适合企业级应用的严格安全要求。**主要限制**在于移动端和SPA(单页应用)支持不佳——SAML依赖浏览器重定向和Cookie,在原生移动App中需要嵌入WebView,用户体验较差;XML解析复杂度高,前端JavaScript处理XML签名困难。

**OIDC**诞生于2014年,构建在OAuth 2.0之上,采用JSON格式的JWT(JSON Web Token)传递身份信息。认证流程:用户访问应用→应用生成Authorization Request并重定向到IdP→用户登录→IdP回调应用并提供authorization code→应用用code交换access_token和id_token(JWT格式)→应用解析id_token获取用户身份。

OIDC的技术优势:JSON格式轻量,JWT可在前后端分离架构中直接传递(存储在localStorage或sessionStorage),原生支持移动端(OAuth 2.0 PKCE扩展防止授权码拦截攻击),支持refresh_token机制实现无感知续期。**主要限制**在于企业遗留应用支持较少——传统企业软件(如SAP、Oracle ERP)多数仅支持SAML,需要IdP同时支持SAML和OIDC协议进行桥接。

选型建议:传统企业应用(SAP、Salesforce、Workday等)优先SAML 2.0;云原生应用、微服务架构、移动App优先OIDC;混合环境选择同时支持两种协议的IdP(Okta、Azure AD均支持)。

### 实施路径与关键约束

某全球零售企业12个月SSO转型案例提供了可复用的实施模式:

**Month 1-2:技术选型与架构设计**。选型时关键决策点包括:预算约束(Okta功能最强但成本最高,Azure AD性价比高但需微软生态),多云支持需求(AWS+Azure+GCP需要选择多云支持均衡的方案),自动化能力(是否需要与HR系统、ITSM工单系统深度集成)。架构设计阶段需明确:用户名格式标准(建议firstname.lastname@company.com全小写,避免大小写导致的匹配问题),MFA强制策略(云平台100%强制MFA,SaaS应用根据敏感度分级),会话超时策略(云平台建议8小时,特权访问建议4小时),条件访问策略(公司网络可放宽MFA要求,外部网络强制MFA+设备信任检查)。

**Month 3-5:Pilot阶段快速验证**。选择技术能力强、配合度高的IT部门(50-100人)作为首批试点,目标是快速发现集成问题并证明价值。Pilot阶段的关键活动:部署IdP租户并配置HR系统SCIM集成,配置云平台SAML联邦(AWS需在每个账户配置IAM Identity Provider和Trust Policy,Azure需配置Enterprise Application,GCP需配置Workforce Identity Federation),集成前10个高频SaaS应用,强制IT部门用户启用MFA。

**Month 6-9:全面推广与自动化**。分波次(4-6个Wave)迁移全员,每个Wave间隔2-3周,给团队时间总结经验和修复问题。全面推广的核心是**自动化用户生命周期管理**:入职自动化(HR创建员工→IdP在5分钟内自动创建账户并分配组→自动授予对应云角色和SaaS权限→自动发送欢迎邮件),离职自动化(HR标记离职→IdP自动禁用账户→自动撤销所有云和SaaS访问→生成离职审计报告),调岗自动化(HR更新部门→IdP自动调整组成员→自动调整权限→通知相关方)。

**Month 10-12:治理优化与审计**。建立权限审查自动化(员工申请权限→自动路由到经理审批→审批通过自动授权→设置90天过期时间并到期提醒),异常行为监控(集成威胁情报自动检测异常登录并触发Step-Up MFA或阻断),合规审计简化(通过IdP API自动生成SOC 2/ISO 27001审计报告)。

**关键约束与边界**:

- **成本约束**:Okta成本较高,需评估是否所有用户都需要完整功能(可考虑Okta+AWS Identity Center混合模式,开发者用Okta高级功能,普通员工用AWS Identity Center降低成本)
- **遗留应用兼容性**:部分老旧系统(2015年前部署)不支持SAML/OIDC,需要使用IdP的LDAP Interface或Radius Proxy作为过渡方案
- **变更管理阻力**:从"直接密码登录"到"SSO登录"改变用户习惯,需要培训和高层支持,销售/业务部门可能以"影响效率"为由抵触
- **网络依赖**:SSO依赖IdP可用性,IdP故障会导致所有应用无法登录,需要设计Break-Glass机制(应急时可绕过SSO的本地管理员账户,严格审计)

**验证方法**:

- **技术验证**:Pilot阶段测试所有认证流程(首次登录、MFA验证、会话超时、设备切换),模拟IdP故障测试Break-Glass流程
- **业务验证**:跟踪IT Helpdesk密码重置工单数量,监控用户登录耗时(SSO应显著降低登录时间),收集用户满意度反馈
- **合规验证**:审计离职员工账户禁用是否100%覆盖(与HR系统交叉验证),测试审计员提出的任意时间点权限追溯问题

**运行指标**:

- MFA覆盖率=启用MFA账户数÷总账户数×100%(目标100%,监控未启用账户并发送提醒/强制禁用)
- SSO集成率=通过SSO访问的应用数÷总应用数×100%(目标>90%,优先集成高频应用)
- 离职账户残留率=离职后仍active的账户数÷离职员工总数×100%(目标0%,每周audit离职清单)
- 密码重置工单占比=密码相关工单数÷总工单数×100%(SSO实施后应从40%+降至<5%)

---

## 5.2.2 多云IAM策略设计:统一语义下的差异化实现

### 三大云平台IAM模型的本质差异

AWS、Azure、GCP虽然都提供基于策略的访问控制,但授权模型、继承逻辑、评估流程存在本质差异,直接影响策略设计和风险控制。

**AWS IAM**采用基于策略(Policy-Based)模型,策略是独立的JSON文档,可附加到身份(Identity-based Policy)或资源(Resource-based Policy)。授权评估遵循"默认拒绝,显式允许"原则,但引入了多个策略层次:Identity-based Policy(直接附加到用户/角色/组的策略)、Resource-based Policy(附加到资源如S3 Bucket的策略)、Permission Boundaries(限制用户/角色的最大权限范围)、Service Control Policies(Organizations级别的全局限制)。评估逻辑:先检查所有策略中是否有显式Deny→检查SCP是否Deny→检查Permission Boundary是否Allow→检查Identity-based或Resource-based Policy是否Allow。任何一层Deny都会直接拒绝访问,只有全部通过才最终Allow。

这种多层策略设计的优势是**精细控制**——可以通过Permission Boundary限制开发者只能在特定VPC创建资源,通过SCP禁止所有账户使用特定高风险服务(如关闭CloudTrail)。**主要挑战**是理解成本高——新手容易被多层策略混淆,且AWS不支持组织级别的策略继承(每个账户的IAM是独立的,需要通过Organizations SCP统一控制)。

**Azure RBAC**采用基于角色(Role-Based)模型,角色是权限的集合(Role Definition),通过角色分配(Role Assignment)将角色授予安全主体(用户/组/服务主体/托管标识)在特定范围(Scope)。Azure引入了**分层继承**:Management Group→Subscription→Resource Group→Resource,子级自动继承父级的角色分配。例如,在Management Group级别授予某用户Contributor角色,该用户自动获得所有子订阅、资源组、资源的Contributor权限。

这种继承设计的优势是**管理效率**——在组织根部配置一次,所有资源自动生效,适合大规模环境。**主要风险**是权限泄露——新手在Root级别误授权会导致全组织继承,且难以发现;Azure的Deny Assignments(拒绝分配)优先级高于所有Allow,但配置接口不直观,容易误配导致合法访问被阻断。

**GCP IAM**结合了策略和角色两种模型,采用IAM Policy Binding结构:在资源层级(Organization/Folder/Project/Resource)绑定角色(Role)到成员(Member),支持IAM Conditions(基于CEL表达式的条件访问)。GCP同样支持分层继承,且提供三类角色:Primitive Roles(Owner/Editor/Viewer,权限过宽不推荐生产环境)、Predefined Roles(GCP管理的细粒度角色如roles/storage.objectViewer)、Custom Roles(自定义权限组合)。

GCP的技术特点是**条件表达式灵活**——通过CEL语言可以表达复杂的时间、地理位置、资源属性条件(如"仅工作时间+美国东部region+资源标签包含env=prod"的复合条件)。**主要限制**是学习曲线陡峭——CEL表达式语法独特,需要单独学习;Custom Roles的权限(Permissions)定义需要深入理解GCP API操作粒度。

### 跨云IAM策略对等设计

实现多云环境权限语义一致性的核心挑战是:如何将业务需求("需要对S3只读访问")翻译成AWS、Azure、GCP三套不同的技术配置,且确保权限范围对等。

以"存储只读权限"为例:

**AWS侧配置**(S3只读):
```json
{
  "Version": "2012-10-17",
  "Statement": [{
    "Effect": "Allow",
    "Action": [
      "s3:GetObject",
      "s3:ListBucket"
    ],
    "Resource": [
      "arn:aws:s3:::prod-data-bucket/*",
      "arn:aws:s3:::prod-data-bucket"
    ],
    "Condition": {
      "IpAddress": {
        "aws:SourceIp": ["10.0.0.0/8", "172.16.0.0/12"]
      }
    }
  }]
}
```

**Azure侧配置**(Storage Blob只读):
```json
{
  "Name": "Storage Blob Data Reader (Prod)",
  "IsCustom": true,
  "Actions": [
    "Microsoft.Storage/storageAccounts/blobServices/containers/read",
    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read"
  ],
  "NotActions": [],
  "DataActions": [
    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read"
  ],
  "NotDataActions": [],
  "AssignableScopes": [
    "/subscriptions/12345678-1234-1234-1234-123456789012/resourceGroups/prod-data-rg"
  ]
}
```
注意Azure区分Actions(控制平面操作,如列出容器)和DataActions(数据平面操作,如读取blob内容),两者需同时配置。IP限制需在Azure AD Conditional Access策略中配置,RBAC本身不支持Condition。

**GCP侧配置**(Storage只读):
```bash
gcloud projects add-iam-policy-binding PROJECT_ID \
  --member='user:developer@company.com' \
  --role='roles/storage.objectViewer' \
  --condition='expression=
    resource.name.startsWith("projects/PROJECT_ID/buckets/prod-data-bucket") &&
    request.ip.matches("10.0.0.0/8") ||
    request.ip.matches("172.16.0.0/12"),
    title=Prod bucket read from corporate network'
```
GCP通过Predefined Role `roles/storage.objectViewer`授予只读权限,通过IAM Conditions的CEL表达式限制IP范围。

### 统一治理方案:联邦身份+CIEM工具组合

多云IAM治理采用双层架构:

**第一层:联邦身份统一认证**。通过中央IdP(Okta/Azure AD)提供统一登录入口,用户通过SAML/OIDC协议联邦到AWS、Azure、GCP,实现"一次登录,多云访问"。关键配置:

- AWS侧创建SAML Identity Provider,配置信任关系(Trust Policy)允许IdP的SAML断言交换临时STS凭证
- Azure侧配置Enterprise Application并设置SAML SSO,或使用Azure AD Connect同步到Azure AD
- GCP侧配置Workforce Identity Federation,映射IdP的用户属性到GCP IAM条件

这一层解决**身份统一**问题——用户不再需要在每朵云创建独立账户,所有访问通过联邦身份追溯到企业IdP。

**第二层:CIEM工具统一可见性**。部署云基础设施权限管理(CIEM)平台,通过只读API扫描所有云账户的权限配置,提供跨云权限分析能力。CIEM工具(Wiz、Ermetic、CloudKnox)典型功能:

- **权限发现**:自动枚举所有云账户的IAM用户/角色/组/服务账户及其附加策略,聚合为统一视图
- **权限风险评分**:识别过度权限(如授予AdministratorAccess但仅使用S3和EC2)、孤立权限(90天未使用)、跨账号信任风险
- **最小权限建议**:基于CloudTrail/Activity Log/Audit Logs分析过去90天实际API调用,生成仅包含实际使用权限的精简策略
- **异常检测**:监控权限变更(新增高权限角色、跨账号AssumeRole关系变化)并实时告警
- **合规报告**:自动生成符合SOC 2/ISO 27001/PCI DSS要求的权限审计报告

这一层解决**权限可见性**问题——从"无法回答某员工拥有哪些权限"到"1小时内生成任意员工的跨云权限清单"。

某SaaS公司6个月CIEM实施案例验证了这一架构的有效性:通过Wiz部署,首次扫描发现23450个权限关系(IAM用户、角色、服务账户、跨账号信任),识别出856个高风险权限(生产环境AdminAccess、S3 DeleteBucket等)、32个僵尸账户、127个未文档化的跨账号信任。经过6个月清理,高风险权限降至12个(经审批的DBA权限),僵尸账户和影子管理员清零,SOC 2审计时间从2周降至1小时。

**实施关键约束**:

- CIEM工具需要跨云只读API权限,需在每个云平台创建专用角色(AWS SecurityAudit托管策略,Azure Reader+Security Reader角色,GCP Viewer+Security Reviewer角色)
- 权限分析依赖CloudTrail等审计日志,建议分析窗口90-180天(太短捕获不到周期性任务,太长计算成本高)
- 最小权限策略自动生成后不应直接应用,需经业务Owner review确认(避免误删应急权限或周期性任务权限)
- CIEM扫描频率建议每日一次(实时监控权限变更),权限清理建议每季度一次(与Access Review流程同步)

---

## 5.2.3 特权访问管理:从共享密码到可审计的临时授权

### 云环境特权账号的风险放大效应

云API的特性将特权账号的破坏力放大到传统环境无法比拟的程度。在传统数据中心,即使攻击者获得root密码,仍需物理接触服务器、突破网络隔离、逐台操作,破坏需要时间积累。但在云环境,单个API调用即可造成全域灾难:`aws s3 rb s3://prod-data --force`可在10秒内删除PB级数据,`aws ec2 terminate-instances --instance-ids $(aws ec2 describe-instances --query 'Reservations[*].Instances[*].InstanceId' --output text)`可在30秒内终止所有EC2实例。

2021年某日志平台遭遇的根账号攻击事故暴露了特权管理缺失的后果:攻击者获取共享AWS root账号密码(存储在离职员工的个人密码管理器中),18分钟内执行了删除所有S3 Bucket、终止所有EC2、删除所有RDS数据库、撤销所有IAM权限的破坏性操作,造成32小时全球业务中断和超过3亿美元损失。事后调查发现,该root账号自2015年创建后密码从未轮换,未启用MFA,5个人共享同一密码(包括已离职员工),没有任何会话监控或操作审计。

特权账号管理的五大核心风险:

1. **内部威胁**:恶意员工(心怀不满的DBA删除生产数据库)、离职员工账户未回收、合法权限滥用(运维工程师窃取客户数据转卖)
2. **凭证泄露**:硬编码到代码commit到GitHub公开仓库(每天约6000个AWS/Azure/GCP凭证泄露到GitHub)、密码出现在日志被日志聚合平台采集、多人共享密码存储在个人工具
3. **合规缺口**:SOX 404要求特权操作可追溯到个人(共享账号无法满足)、PCI DSS要求特权访问基于审批流程(永久Admin权限不合规)、HIPAA要求访问日志和审计追踪
4. **审计盲区**:共享账号日志仅显示账号名无法确定操作人、无会话录制无法还原操作过程、跨云日志分散无法关联分析
5. **权限常驻**:开发者因应急被授予Admin权限后忘记撤销、Kubernetes ServiceAccount Token默认无过期时间、缺乏定期权限审查机制

### PAM平台架构与核心组件

企业级特权访问管理(PAM)平台通常包含四个核心组件:

**密码保管库(Password Vault)**:集中存储所有特权账号凭证(AWS IAM密钥、Azure服务主体密钥、Linux root密码、数据库sa密码、SSH私钥等),使用AES-256加密存储,支持双人控制(高危凭证的Retrieve操作需2人审批)。关键功能:自动密码轮换(通过CPM组件定期调用云API更改密码,无需人工干预)、密码签出审计(记录谁在何时取出了哪个凭证,用于何种业务目的)、凭证版本管理(保留历史密码版本用于回滚和审计)。

**会话管理器(Session Manager)**:作为代理(Proxy)拦截所有特权访问会话(SSH、RDP、HTTPS),强制所有操作经过PAM平台。用户不再直接SSH到服务器,而是SSH到Session Manager,Session Manager验证用户身份和权限后,代理连接到目标服务器并全程录制会话(视频录像+键盘输入+剪贴板+文件传输)。会话录像加密存储并保留指定时长(金融行业通常要求5年),用于事后审计和事故调查。

**特权提升(Privilege Elevation)**:实现Just-in-Time(JIT)临时授权,替代永久Admin权限。用户默认仅有只读权限,需要执行高权限操作(如部署生产环境、修改数据库Schema)时,通过Portal或API申请临时权限,经审批后PAM平台自动创建临时IAM角色或SSH会话,有效期2-8小时,到期自动撤销。JIT的核心优势是将特权账号的"攻击窗口"从永久缩短为数小时,显著降低凭证泄露和内部威胁风险。

**审计与合规报告**:自动收集所有特权访问活动(谁、何时、访问了什么资源、执行了哪些操作、是否经过审批),生成符合SOX/PCI DSS/HIPAA要求的审计报告。支持异常检测(非工作时间登录、多次失败认证、执行敏感命令如DROP DATABASE)并实时告警,集成SIEM平台进行关联分析。

### PAM工具选型与实施路径

主流PAM平台在功能完整性、云支持、成本上存在差异:

**CyberArk**定位为企业级PAM领导者,提供最全面的功能(密码保管库、会话管理、特权提升、DevOps密钥管理),支持AWS/Azure/GCP多云环境,市场份额约35%。核心优势是**金融行业认可度**——全球Top 20银行中17家使用CyberArk,符合严格合规要求(SOX/PCI DSS/HIPAA全覆盖),支持Active-Active高可用部署满足金融级RPO/RTO。主要限制是学习曲线陡峭,部署周期较长(企业级部署通常需3-6个月),成本较高(150个特权账号License首年约28万美元,包含实施服务)。

**BeyondTrust**定位为统一特权管理,整合了密码安全、会话管理、端点特权管理(EPM)、远程访问多个功能模块,市场份额约25%。特点是**功能模块化**——企业可根据需求选择部署Password Safe(密码管理)、Privilege Remote Access(远程访问)、Privilege Management(端点特权管理)等模块,灵活组合。适合从单一功能(如密码管理)开始逐步扩展到全面PAM的企业。

**Delinea(原Thycotic)**定位为云优先PAM,SaaS部署模式降低基础设施成本,专注中小企业和云原生场景,市场份额约15%。优势是**部署快速**——SaaS模式无需本地部署,30天内可上线;云集成简单,原生支持AWS Secrets Manager、Azure Key Vault集成。限制是高级功能(如大规模会话录制、复杂审批工作流)不如CyberArk/BeyondTrust全面,适合预算有限、快速上线需求的中小企业。

某金融机构9个月PAM实施案例提供了可复用模式:

**Month 1-2:选型与差距分析**。选择CyberArk(金融合规要求、高可用架构、会话录制能力),同时进行SOX/PCI DSS合规差距分析,识别出38项不合规(无密码轮换、无会话审计、共享账号、僵尸特权账号等)。

**Month 3-5:部署与Pilot**。部署Primary Vault(AWS us-east-1高可用双AZ)、DR Vault(us-west-2灾备)、CPM(密码轮换组件)、PSM(会话代理)、PVWA(Web Portal),配置密码轮换策略(AWS IAM 7天、Azure Service Principal 30天、Linux root 14天),部署会话代理(所有SSH/RDP必须经过PSM,会话录制加密存储S3保留5年),集成Azure AD SSO。Pilot阶段选择IT安全团队25人测试,发现并解决会话延迟(优化PSM网络部署)、DevOps抵触(集成Slack Bot简化申请流程)、老旧系统兼容性(使用SSH Key轮换代替密码轮换)问题。

**Month 6-8:全面推广**。分3个Wave推广:Wave 1(IT安全+DevOps 80人,管理云环境特权)、Wave 2(基础架构+DBA 120人,管理本地服务器和数据库)、Wave 3(第三方供应商35人,JIT临时权限,合同结束自动撤销)。每个Wave启动前强制培训(2小时线上+1小时实操),解决变更管理阻力(DBA抱怨密码轮换导致脚本失效→改用AAM模块动态获取密码;Linux管理员抱怨PSM慢→优化网络延迟并演示会话录像的合规价值)。

**Month 9:审计与持续优化**。9月底SOX 404审计:82个Safe管理1287个特权账号,100%纳入管理0共享账号,平均密码轮换周期从1年+降至7-30天,单月录制3420个会话总时长1850小时,生产环境Admin权限100%改为JIT(平均2小时有效期),高危操作87次双人审批(12次被拒绝)。审计结论从"Material Weakness"改为"No Finding"。

**实施关键约束**:

- **文化阻力大于技术挑战**:从"共享密码随意用"到"每次申请JIT",从"SSH直连"到"通过PSM代理",每个改变都遭遇抵触,需要培训(讲清楚合规风险)+简化流程(Slack Bot降低使用门槛)+高层支持
- **Pilot测试不可跳过**:25人试点发现的会话延迟、DevOps抵触、老旧系统兼容性问题,如果在全面推广时才发现会导致项目严重延期
- **自动化是规模化关键**:1287个特权账号手工轮换不可能,CPM自动密码轮换是项目成功基础
- **Break-Glass流程必须设计**:PAM平台故障会导致所有特权访问中断,需设计应急流程(本地管理员账户绕过PAM,严格审计)并定期演练

**验证方法**:

- 模拟攻击测试:Red Team尝试获取特权账号密码(测试保管库安全性)、绕过会话录制(测试PSM强制代理)、长期持有Admin权限(测试JIT自动撤销)
- 合规审计演练:提前3个月模拟SOX/PCI DSS审计,测试能否快速提供特权访问记录、会话录像、审批流程证据
- 灾备演练:模拟Primary Vault故障,测试DR Vault切换是否影响业务(RPO/RTO是否满足要求)

**运行指标**:

- 特权账号纳管率=PAM管理账号数÷特权账号总数×100%(目标100%,定期扫描识别未纳管账号)
- 密码轮换合规率=按计划轮换账号数÷应轮换账号数×100%(目标100%,监控轮换失败并告警)
- JIT权限使用率=JIT授权次数÷特权访问总次数×100%(目标>90%,降低常驻权限)
- 会话录制覆盖率=录制会话数÷特权会话总数×100%(目标100%,检测绕过PSM的直连)
- 双人审批触发率=触发双人审批操作数÷高危操作总数×100%(目标100%,验证高危操作强制控制)

---

## 5.2.4 零信任架构:从网络边界到身份边界

### 传统边界防护模型的失效

传统网络安全依赖"城堡-护城河"模型:在企业网络边界部署防火墙/VPN,假设边界内=可信、边界外=不可信,一旦通过VPN认证即可访问所有内网资源。这种模型在云时代面临三个致命缺陷:

第一,**边界模糊化**。员工在家办公、承包商在咖啡馆访问、SaaS应用在公有云、微服务在Kubernetes集群、数据存储在S3——"内网"边界已不存在。传统VPN只能保护"员工→公司数据中心"路径,但云环境中大量访问路径(员工→SaaS、微服务→云数据库、Lambda→S3)完全绕过VPN。

第二,**横向移动风险**。一旦攻击者突破边界(通过钓鱼攻陷一台员工笔记本),VPN假设其为可信流量,内网防火墙不再检查,攻击者可横向移动到所有内部系统。2020年某电信运营商事故:攻击者钓鱼攻陷客服笔记本→通过VPN连接内网→横向移动12个网络段→访问47个系统→窃取3.7亿用户信息,用时23天但安全团队完全未发现(因为"VPN流量=可信")。

第三,**设备信任缺失**。传统VPN仅验证用户凭证,不检查设备健康状态。丢失的笔记本(保存VPN证书和自动登录配置)被拾获后,拾获者可直接获得VPN访问权限。2019年某科技公司MacBook丢失事故:开发者MacBook被偷→小偷获得VPN访问→访问生产代码仓库和数据库,企业用3天才发现MacBook丢失,用2天确认VPN证书泄露,期间生产环境已被访问。

### 零信任架构核心原则

零信任架构(Zero Trust Architecture, ZTA)通过"Never Trust, Always Verify"(永不信任,持续验证)原则重构安全模型:

**原则1:网络位置不决定信任**。无论访问来自企业内网、VPN还是公共互联网,都需要经过同等强度的认证授权,不再假设"内网=可信"。

**原则2:设备与用户双重验证**。不仅验证用户身份(通过IdP+MFA),还验证设备健康状态(操作系统补丁、防病毒软件、磁盘加密、设备证书),两者都满足要求才允许访问。

**原则3:所有访问需认证授权**。包括内部资源访问(微服务A访问微服务B)也需要显式认证授权(通过mTLS+JWT),不再依赖网络层隔离。

**原则4:动态访问控制**。基于实时上下文(用户角色、设备状态、地理位置、访问时间、资源敏感度、行为异常检测)动态决策是否授权,而非静态策略。

**原则5:微隔离**。应用级访问控制,每个应用独立认证授权,防止横向移动(即使攻击者攻陷应用A,也无法自动访问应用B)。

### Google BeyondCorp实施模型

Google的BeyondCorp是业界首个大规模零信任实践(2011年启动,2014年论文发表,2019年开源部分组件),核心架构包含五个层次:

**Access Proxy(访问代理)**:所有应用访问必须经过统一的Access Proxy,Proxy负责:身份认证(集成Google Workspace IdP)、设备信任检查(查询设备清单确认设备已注册并符合安全基线)、上下文分析(IP地理位置、访问时间、最近行为是否异常)、风险评分(综合用户、设备、上下文计算风险分数)、策略评估(根据风险分数和资源敏感度决定Allow/Deny/Step-Up MFA)。

**Device Inventory(设备清单)**:所有允许访问企业资源的设备必须注册到设备清单,包含设备属性(型号、操作系统、所有者、部门)、安全状态(磁盘是否加密、防病毒是否启用、操作系统补丁级别)、设备证书(用于mTLS双向认证)。设备健康状态持续评估,不符合安全基线的设备自动降低信任等级或禁止访问。

**User & Group Directory(用户和组目录)**:集成企业IdP(Google Workspace),定义用户身份、组织架构、角色。访问策略基于用户属性(部门、职位、地理位置)和组成员资格动态评估。

**Trust Inference(信任推断)**:基于机器学习分析用户历史行为(登录时间模式、常用地理位置、常访问资源),实时检测异常行为(非工作时间从陌生国家登录、访问从未访问过的敏感资源),异常行为触发Step-Up认证(额外MFA验证)或自动阻断。

**Access Control Engine(访问控制引擎)**:根据策略决策引擎(Policy Decision Point)评估结果,执行访问控制(Policy Enforcement Point)。策略支持细粒度条件表达式,如"允许研发部门(User Group)从已注册设备(Device Inventory)在工作时间(Time Condition)访问开发环境应用(Resource Sensitivity),需MFA验证(Authentication Strength)"。

### 分阶段实施路线图

零信任转型是多年渐进式过程,典型分三阶段:

**阶段1:身份中心化(0-6个月)**

目标:建立统一身份基础设施,实现MFA 100%覆盖,注册企业设备。

关键活动:
- 部署企业级IdP(Okta/Azure AD),集成HR系统实现自动化用户生命周期管理
- 强制启用MFA,覆盖所有用户账户(云平台、SaaS应用、VPN),无例外(可使用多种MFA方式如Push Notification、TOTP、FIDO2满足不同场景)
- 部署移动设备管理(MDM)或统一端点管理(UEM)平台(Microsoft Intune、Jamf、VMware Workspace ONE),注册企业设备并分发设备证书
- 配置条件访问策略Pilot(基于用户组、设备状态、网络位置的动态授权),在IT部门试点验证

KPI:SSO覆盖率>90%(核心应用优先集成)、MFA启用率=100%、设备注册率>95%(企业配发设备强制注册,BYOD设备鼓励注册)

**阶段2:网络微隔离(6-12个月)**

目标:移除VPN全流量访问,实施应用级访问控制,部署零信任网络访问(ZTNA)网关。

关键活动:
- 选型ZTNA平台(Zscaler Private Access、Cloudflare Access、Palo Alto Prisma Access),部署ZTNA网关
- 分析现有VPN流量,识别应用依赖关系(哪些用户访问哪些应用,访问频率、数据量),梳理前20个高频应用
- 将核心应用迁移到ZTNA(用户通过IdP认证后,ZTNA网关根据策略动态建立应用级隧道,无需VPN全流量),逐步减少VPN依赖
- 配置应用级访问策略(每个应用独立定义允许访问的用户组、设备要求、MFA强度、会话超时),实现微隔离
- 监控VPN流量占比,目标降至<5%(仅保留遗留应用过渡期使用)

KPI:ZTNA覆盖应用数>80%(核心业务应用优先)、VPN流量占比<5%、访问延迟<100ms(ZTNA网关优化部署位置避免性能损失)

**阶段3:持续验证(12-18个月)**

目标:实施风险自适应访问控制,基于实时威胁情报和行为分析动态调整信任等级。

关键活动:
- 部署用户行为分析(UEBA)平台,建立用户行为基线(正常登录时间、常用地理位置、常访问资源),实时检测异常(Account Takeover、Insider Threat、Data Exfiltration)
- 集成威胁情报源(IP信誉库、恶意域名库、已泄露凭证数据库),实时检测高风险访问(来自Tor网络、使用已泄露密码)
- 实施风险自适应策略:低风险(正常行为)→正常访问,中风险(轻微异常如新地理位置)→强制重新认证或Step-Up MFA,高风险(严重异常如访问从未访问过的敏感数据)→自动阻断+告警SOC
- 部署自动化响应(失陷设备自动隔离网络、异常用户自动降权、可疑会话自动中断),缩短MTTR
- 建立持续设备健康评估(每小时检查设备补丁、防病毒、磁盘加密状态),不合规设备自动降低信任等级

KPI:风险检测准确率>95%(减少误报)、误报率<2%(避免影响正常业务)、MTTR<15分钟(从检测到隔离的平均时间)

**关键约束与边界**:

- **遗留应用兼容性**:部分老旧应用不支持现代认证协议(如仅支持Kerberos不支持SAML/OIDC),需要使用协议桥接或保留过渡期VPN访问
- **性能影响**:所有访问经过Access Proxy会增加延迟(通常20-100ms),需优化Proxy部署位置(靠近用户和应用)并使用CDN加速
- **用户体验**:频繁的MFA验证和设备检查可能影响用户体验,需要平衡安全和便利(如使用设备信任机制,已注册设备30天内免MFA)
- **成本投入**:ZTNA平台、UEBA、威胁情报订阅、设备管理平台均有成本,需提前规划预算(中型企业1000用户约15-30万美元/年)

**验证方法**:

- Red Team测试:模拟攻击者攻陷一台设备后尝试横向移动(测试微隔离是否有效)、尝试使用已泄露凭证登录(测试威胁情报集成)、尝试从异常地理位置访问敏感资源(测试上下文分析和风险评分)
- 用户体验测试:跟踪应用访问延迟(对比ZTNA实施前后)、收集用户满意度反馈(MFA频率是否过高)、监控IT Helpdesk工单(访问问题是否增加)
- 合规审计:验证所有访问是否经过认证授权(检查绕过Access Proxy的直连)、验证设备健康检查是否持续执行、验证异常访问是否被记录和告警

**运行指标**:

- 零信任覆盖率=通过ZTNA访问的应用数÷总应用数×100%(目标>80%)
- 设备合规率=符合安全基线设备数÷已注册设备数×100%(目标>95%)
- 异常检测触发率=异常访问检测数÷总访问数×100%(监控指标,无固定目标,需持续调优降低误报)
- 自动化响应率=自动处理事件数÷检测事件数×100%(目标>70%,减少人工干预)

---

## 5.2.5 IAM治理与审计:从权限黑箱到可审计透明

### 基于CloudTrail的权限使用分析

云环境权限治理的核心挑战是区分"已授予权限"和"实际使用权限"。AWS IAM用户可能被授予AdministratorAccess策略(包含800+权限),但实际仅使用S3和EC2相关的20个API操作,其余780个权限完全未使用,构成巨大的过度授权风险。

权限使用分析通过挖掘CloudTrail审计日志实现:CloudTrail记录所有AWS API调用(包括调用者身份、操作名称、目标资源、时间戳、源IP等),通过分析过去90-180天的日志,统计每个IAM身份实际调用过的API集合,与策略授予的权限对比,识别未使用权限。

分析流程:

1. **枚举已授予权限**:通过IAM API(GetUserPolicy、ListAttachedUserPolicies、GetPolicy、GetPolicyVersion)获取用户附加的所有策略(内联策略、附加策略、组策略),解析JSON文档中的Action字段,展开通配符(如s3:*展开为所有S3 API操作),得到理论权限集合。

2. **查询实际API调用**:通过CloudTrail API(LookupEvents)或Athena查询CloudTrail日志(通常存储在S3),筛选UserIdentity字段匹配目标用户的所有事件,提取EventName字段(即实际调用的API操作),去重得到实际使用权限集合。

3. **计算权限使用率**:权限使用率=实际使用权限数÷已授予权限数×100%。使用率<30%触发人工review,使用率<10%强制生成最小权限策略建议。

4. **生成最小权限策略**:基于实际使用权限集合,生成仅包含这些操作的精简策略,提交给身份Owner审批。审批通过后通过IaC(Terraform/CloudFormation)应用新策略,撤销原有过度权限。

**关键约束**:

- **分析窗口期选择**:90天窗口平衡准确性和时效性(太短捕获不到月度/季度周期性任务,太长计算成本高且策略可能已变化),季度性任务建议使用180天窗口
- **应急权限保留**:Break-Glass账户、灾难恢复账户的权限虽然日常未使用,但必须保留,需在分析时白名单排除
- **业务Owner确认**:自动生成的最小权限策略不应直接应用,需经业务Owner review确认(避免误删未在窗口期触发的合理权限)
- **CloudTrail日志完整性**:分析依赖CloudTrail日志,需确保CloudTrail已启用且日志完整保留(检查是否有日志缺失、S3 Bucket权限是否正确)

### 权限生命周期管理流程

权限生命周期管理(Identity Governance & Administration, IGA)覆盖Joiner-Mover-Leaver全流程:

**Joiner(入职)**:HR系统(Workday)创建员工记录→通过SCIM协议自动同步到IdP(Okta)→IdP根据员工属性(部门、职位)自动分配到预定义组→组成员资格自动映射为云平台角色(AWS Developer、Azure Contributor、GCP Editor)和SaaS应用权限→自动发送欢迎邮件包含账户激活链接和MFA设置指南。关键是实现"零人工干预",新员工首日即可访问所需资源,无需IT手工创建账户。

**Mover(岗位变动)**:HR系统更新员工部门/职位→IdP检测属性变更→自动调整组成员资格(离开旧组,加入新组)→自动调整云平台角色和SaaS权限(撤销旧部门权限,授予新部门权限)→自动通知员工和经理权限变更内容。关键是确保权限变更原子性(撤销和授予同时生效,避免中间状态导致权限真空或叠加)。

**Leaver(离职)**:HR系统标记员工离职→IdP在5分钟内自动禁用账户→自动撤销所有云平台权限(AWS删除IAM用户或禁用角色、Azure禁用用户、GCP移除IAM绑定)→自动撤销所有SaaS应用访问→生成离职审计报告(列出该员工曾拥有的所有权限、最后访问时间、是否存在未归还资产)→归档用户数据(邮箱、文件)。关键是速度和覆盖率,离职当天必须完成所有权限撤销,0遗漏。

**Access Review(定期审查)**:每季度自动发起权限审查Campaign→系统自动生成待审查清单(所有Admin/Owner角色、90天未使用权限、异常高权限、第三方/外包人员访问)→自动路由给相关Manager进行Certification(确认该员工是否仍需要该权限)→Manager点击Approve/Revoke→系统自动应用Manager决策(保留或撤销权限)→生成审查报告(审查覆盖率、撤销权限数量、Manager响应时间)。关键是自动化减少Manager负担(只需点击确认,无需手工查询权限),同时确保合规要求(SOX/PCI DSS要求至少每季度审查特权账号)。

### CIEM工具对比与选型

云基础设施权限管理(CIEM)工具通过API扫描云环境,提供跨云权限可见性:

**Ermetic(被Tenable收购)**:定位为权限分析+CSPM整合平台,支持AWS/Azure/GCP/Kubernetes,核心优势是**ML驱动的最小权限建议**——通过机器学习分析用户行为模式,预测合理权限范围,自动生成策略建议。适用场景:中大型企业,需要深度权限分析和自动化修复建议。

**CloudKnox(被微软收购,现为Microsoft Entra Permissions Management)**:定位为权限治理专精工具,对Azure环境支持最深,同时支持AWS/GCP。核心优势是**基于实际使用生成策略**——分析CloudTrail/Activity Log/Audit Logs,统计过去90天实际API调用,自动生成仅包含实际使用权限的精简策略。适用场景:微软生态为主,已有Azure AD Premium P2许可证(部分功能包含在订阅中)。

**Wiz**:定位为全栈云安全平台(CIEM+CSPM+CWPP+KSPM),支持AWS/Azure/GCP/Kubernetes/OCI,核心优势是**风险驱动修复建议**——不仅分析权限配置,还结合漏洞、暴露面、网络路径进行风险评分,优先修复高风险权限。适用场景:需要全面云安全平台,整合权限管理、配置合规、工作负载保护的企业。

选型建议:多云环境且需要深度分析选Ermetic,微软生态为主选CloudKnox,需要整合CSPM+CWPP选Wiz。

### 合规审计报告生成

IAM合规审计通常需要回答以下问题:

1. **控制有效性验证**:MFA是否100%启用(抽样检查N个账户,验证MFA配置状态)、管理员权限是否需要审批(检查审批记录是否完整)、Access Key是否定期轮换(检查Key创建时间,超过90天标记为不合规)

2. **权限变更追踪**:过去季度新增了哪些高权限角色(查询CloudTrail CreateRole/AttachRolePolicy事件,筛选Admin级别权限)、谁授予了这些权限(UserIdentity字段)、是否经过审批(关联工单系统审批记录)

3. **离职员工清理**:过去季度离职员工清单(从HR系统获取)、这些员工的云账户是否已禁用(交叉验证IAM用户状态)、禁用时间是否在离职当天(计算时间差)

4. **异常访问检测**:是否有非工作时间的高权限操作(查询CloudTrail,筛选Admin操作且时间在18:00-08:00)、是否有异常地理位置登录(SourceIP geo-location与员工常驻地不符)、是否有失败的权限提升尝试(AssumeRole denied事件)

审计报告模板应包含:审计范围(哪些云账户/订阅/项目)、审计周期(2025 Q3)、控制点测试结果(通过/失败/发现问题)、发现问题详细描述(问题描述、影响、根因、补救措施、责任人、截止日期)、审计证据附件(MFA配置导出、权限变更日志、离职清单、审批记录截图)、审计结论(整体控制有效性评估)、审计人员签字。

某金融机构SOX审计案例:审计员要求证明"所有生产环境Admin权限需要双人审批",企业通过以下证据满足:CyberArk审批记录(列出所有Admin密码签出请求,包含申请人、审批人、时间、业务目的)、CloudTrail日志(所有AssumeRole到Admin角色的事件,UserIdentity匹配审批通过的申请人)、会话录像样本(随机抽查10个Admin会话,验证操作与申请目的一致)。审计员接受证据,评估控制为"有效"。

---

## 本节小结

云身份与访问管理是云安全的基础控制层,其有效性直接决定云环境的整体安全水平。本节从五个维度建立了完整的IAM控制体系:

**统一身份管理**通过三层架构(HR系统→中央IdP→目标应用)解决多云身份孤岛问题,将N×M问题简化为N+M问题,实现入离职自动化和审计追踪统一。关键决策包括IdP选型(Okta多云均衡、Azure AD成本效益、AWS Identity Center单云适用)、协议选择(SAML 2.0企业应用优先、OIDC云原生应用优先)、实施路径(Pilot验证→分波次推广→自动化治理)。

**多云IAM策略设计**应对AWS/Azure/GCP三套权限模型的差异,通过联邦身份统一认证+CIEM工具统一可见性实现跨云治理。核心挑战是理解各云平台的授权逻辑(AWS多层策略评估、Azure分层继承、GCP条件表达式),确保跨云权限语义对等。

**特权访问管理**通过四大组件(密码保管库、会话管理、特权提升、审计报告)将特权账号从"共享密码裸奔"转变为"可审计的临时授权"。实施重点是文化变革(从"特权即自由"到"特权即责任")、自动化规模化(密码轮换、JIT授权)、合规证据生成(会话录像、双人审批记录)。

**零信任架构**通过"Never Trust, Always Verify"原则重构安全边界,从网络边界转向身份边界。分三阶段实施:身份中心化(SSO+MFA+设备注册)→网络微隔离(ZTNA替代VPN)→持续验证(UEBA+风险自适应访问)。关键约束包括遗留应用兼容性、性能影响、用户体验平衡。

**IAM治理与审计**通过权限使用分析(基于CloudTrail)、生命周期管理(Joiner-Mover-Leaver-AccessReview)、CIEM工具(跨云权限可见性)建立持续治理机制。合规审计需要准备控制有效性证据(MFA配置、审批记录、会话录像)并能快速回答审计员提问。

### 实施检查清单

**基础级(0-6个月)**

- [ ] 部署企业SSO平台(Okta/Azure AD),集成HR系统SCIM自动化
- [ ] 强制启用MFA,覆盖所有用户账户,无例外(目标100%)
- [ ] 禁用AWS root账户日常使用,启用root账户MFA和告警
- [ ] 集成Top 20高频应用到SSO(云平台+关键SaaS应用)
- [ ] 建立IAM策略模板库(按角色分类:Developer/Operator/Auditor等)
- [ ] 启用CloudTrail/Activity Log/Audit Logs,集中存储到专用S3/Storage Account

**进阶级(6-12个月)**

- [ ] 部署CIEM工具(Wiz/Ermetic/CloudKnox),扫描权限配置
- [ ] 实施JIT临时访问(管理员权限默认撤销,需要时申请2-8小时临时授权)
- [ ] 部署PAM平台(CyberArk/BeyondTrust),管理特权账号密码和会话
- [ ] 建立90天权限定期复审流程(Manager Certification)
- [ ] 实施Access Key自动轮换(90天强制轮换或迁移到临时凭证)
- [ ] 配置条件访问策略(基于设备状态、网络位置、风险评分的动态授权)

**高级级(12-18个月)**

- [ ] 部署ZTNA平台,迁移核心应用,VPN流量占比降至<5%
- [ ] 实施风险自适应访问控制(UEBA异常检测+自动化响应)
- [ ] 部署设备信任评估(MDM/UEM,持续检查设备健康状态)
- [ ] 实施异常行为自动响应(失陷设备自动隔离、异常用户自动降权)
- [ ] 建立跨云审计日志归集分析(CloudTrail+Activity Log+Audit Logs→SIEM)
- [ ] 优化权限治理(基于CloudTrail分析生成最小权限策略,自动化权限清理)

### 常见陷阱与避免方法

| 陷阱 | 描述 | 避免方法 |
|------|------|---------|
| **过度授权** | 为方便直接授予AdministratorAccess | 使用Permission Boundaries限制最大权限范围+基于CloudTrail分析生成最小权限策略 |
| **长期凭证** | Access Key/密码永不过期,泄露风险高 | 强制90天轮换策略+迁移到临时凭证(STS AssumeRole)+监控超期Key并告警 |
| **共享账号** | 团队共用一个账号,无法追踪个人操作 | 为每个人创建个人账号+通过IAM角色实现权限共享(AssumeRole)+PAM审计 |
| **MFA绕过** | 部分应用不强制MFA,成为攻击入口 | 条件访问策略全覆盖(IdP层面强制MFA)+定期扫描未启用MFA账户并禁用 |
| **离职遗漏** | 离职员工账号未禁用,成为僵尸账户 | 自动化IGA流程(HR系统→IdP→云平台)+每周审计离职清单交叉验证 |
| **审计盲区** | 跨云日志未归集,无法关联分析 | 集中日志到统一SIEM平台+建立跨云关联规则+定期审计测试 |
| **应急流程缺失** | IdP/PAM故障导致所有访问中断 | 设计Break-Glass流程(本地管理员账户绕过SSO/PAM)+严格审计+定期演练 |

### 延伸阅读

**标准与框架**:
- NIST SP 800-63 Digital Identity Guidelines:https://pages.nist.gov/800-63-3/
- NIST SP 800-207 Zero Trust Architecture:https://csrc.nist.gov/publications/detail/sp/800-207/final
- CSA Cloud Identity and Access Management Guidelines:https://cloudsecurityalliance.org/
- CIS Controls v8 - Identity and Access Management:https://www.cisecurity.org/controls/v8

**技术文档**:
- AWS IAM Best Practices:https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
- Azure RBAC Documentation:https://learn.microsoft.com/azure/role-based-access-control/
- GCP IAM Overview:https://cloud.google.com/iam/docs/overview
- Okta Identity 101:https://www.okta.com/identity-101/

**开源工具**:
- Prowler(AWS安全评估):https://github.com/prowler-cloud/prowler
- ScoutSuite(多云审计):https://github.com/nccgroup/ScoutSuite
- CloudMapper(AWS可视化):https://github.com/duo-labs/cloudmapper
- Parliament(AWS IAM策略分析):https://github.com/duo-labs/parliament

---

**下一节**:[5.3 云网络安全](./5.3_cloud_network_security.md) - VPC架构设计、微隔离策略、DDoS防护、WAF规则、CDN安全

---

## 📍 导航 | Navigation

**[← 上一节](./5.1_cloud_security_strategy.md)** | **[返回 Chapter 5](./README.md)** | **[返回 Part 2](../)** | **[→ 下一节](./5.3_cloud_network_security.md)**

---

**© 2025 AI-ESA Project. Licensed under CC BY-NC-SA 4.0**
